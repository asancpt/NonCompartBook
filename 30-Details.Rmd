# NCA 소프트웨어 {#Details}

## 이 장에서는 {#detailschapter}

이 장에서는 몇가지 NCA 용 소프트웨어(상용 소프웨어, R 패키지)를 비교하고 분석하여 그 결과와 사용법의 공통점과 차이점을 알아볼 것입니다.
특별히 Theoph 데이타셋에서 C~max~, AUC~inf~가 동일하게 나오는지 초점을 맞추어 실펴보겠습니다.

## Certara Phoenix WinNonLin

<https://www.certara.com/software/pkpd-modeling-and-simulation/phoenix-winnonlin/>

### Pros

- Validated for several years
- Industry standard
- Versatile unit setting
- Easy using by GUI 
- Generating plots supported

### Cons

- Expansive (~several thousand dollars)
- Not suitable for reproducible research
- CDISC SDTM not compatible (input and output)

## R package: pkr

Extension of NonCompart for CDISC input

### Pros

- Open source and free of charge
- CDISC SDTM fully compatible (input - DM, EX, PC)
- Output of CDISC SDTM PP domain terms 
- Calculate partial(interval) AUC with 'linear' or 'log' interpolation method

### Cons

- More tests required
- Experience with R language required
- Generating plots not supported for now (To be supported soon)

```{r}
# Theoph and Indometh data: dose in mg, conc in mg/L, time in h
pkr::NCA(Theoph, "Subject", "Time", "conc", dose=320, uConc="mg/L")
pkr::NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", uConc="mg/L")
```

## R package: PKNCA
<https://github.com/billdenney/pknca>

### Pros

- Open source and free of charge
- CDISC SDTM semi compatible (output)
- Calculate partial(interval) AUC with 'linear' or 'log' interpolation method but in a cumbersome way

### Cons

- CDISC SDTM not compatible (input)
- More tests required
- Experience with R language required
- Generating plots not supported for now (To be supported soon)

```{r}
library(PKNCA)

my.conc <- PKNCAconc(as.data.frame(Theoph), conc~Time|Subject)
d.dose <- unique(datasets::Theoph[datasets::Theoph$Time == 0,
                                  c("Dose", "Time", "Subject")])
my.dose <- PKNCAdose(d.dose, Dose~Time|Subject)
my.data.automatic <- PKNCAdata(my.conc, my.dose)
my.results.automatic <- pk.nca(my.data.automatic)
my.results.automatic$result %>% filter(grepl(pattern = "cmax|aucinf", PPTESTCD)) %>% 
    arrange(PPTESTCD)
summary(my.results.automatic)
```

## R package: ncappc

NCA Calculation and Population PK Model Diagnosis [@Acharya201683]

<https://cran.r-project.org/web/packages/ncappc/index.html>
<https://www.ncbi.nlm.nih.gov/pubmed/27000291>

```{r}
#install.packages("ncappc")
library(ncappc)
```

```{r eval = FALSE}
library(ncappc)

write.csv(Theoph %>% rename(ID = Subject, TIME = Time, DV = conc), 
          "Theoph.csv", row.names = FALSE)
ncappc(obsFile="Theoph.csv", psnOut = FALSE, noPlot = TRUE, printOut = TRUE, 
       method = "linear-log", evid = FALSE)
Theoph_ncappc <- read.delim("ncaOutput-.tsv", sep = "\t", check.names = FALSE)
Theoph_ncappc[ , c("Cmax (M.L^-3)", "AUCINF_obs (T*M.L^-3)")]
```

```{r echo = FALSE}
Theoph_ncappc <- read.delim("ncaOutput-.tsv", sep = "\t", check.names = FALSE)
Theoph_ncappc[ , c("Cmax (M.L^-3)", "AUCINF_obs (T*M.L^-3)")]
```

## R package: PK

Basic Non-Compartmental Pharmacokinetics

<https://cran.r-project.org/web/packages/PK/index.html>


```{r}
#install.packages("PK")
library(PK)
```

## Kinetica

## Scientist

## PKSolver

## Summary

```{r echo = FALSE}
knitr::kable(read.csv("comparison.csv", check.names = FALSE))
```
