<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Noncompartmental Analysis by R Packages</title>
  <meta name="description" content="In this book, we will compare, review and discuss R Packages for noncompartmental analysis.">
  <meta name="generator" content="bookdown 0.3.11 and GitBook 2.6.7">

  <meta property="og:title" content="Noncompartmental Analysis by R Packages" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://asancpt.github.io/pkrBook/docs" />
  <meta property="og:image" content="http://asancpt.github.io/pkrBook/docsbookcover.jpg" />
  <meta property="og:description" content="In this book, we will compare, review and discuss R Packages for noncompartmental analysis." />
  <meta name="github-repo" content="asancpt/pkrBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Noncompartmental Analysis by R Packages" />
  
  <meta name="twitter:description" content="In this book, we will compare, review and discuss R Packages for noncompartmental analysis." />
  <meta name="twitter:image" content="http://asancpt.github.io/pkrBook/docsbookcover.jpg" />

<meta name="author" content="Kyun-Seop Bae">
<meta name="author" content="Sungpil Han">
<meta name="author" content="Seok Kyu Yoon">
<meta name="author" content="Yong-Soon Cho">


<meta name="date" content="2017-03-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction.html">
<link rel="next" href="result.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">Noncompartmental Analysis by R Packages</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 책 머리에</a></li>
<li class="chapter" data-level="" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> 서론</a></li>
<li class="chapter" data-level="3" data-path="method.html"><a href="method.html"><i class="fa fa-check"></i><b>3</b> 이론 및 계산 방법</a></li>
<li class="chapter" data-level="4" data-path="result.html"><a href="result.html"><i class="fa fa-check"></i><b>4</b> 결과 및 논의</a></li>
<li class="chapter" data-level="5" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>5</b> 결론</a></li>
<li class="chapter" data-level="6" data-path="acknowledgement.html"><a href="acknowledgement.html"><i class="fa fa-check"></i><b>6</b> 감사의 글</a></li>
<li class="chapter" data-level="7" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i><b>7</b> 참고문헌</a></li>
<li class="chapter" data-level="8" data-path="pkr-r-package.html"><a href="pkr-r-package.html"><i class="fa fa-check"></i><b>8</b> pkr R package</a><ul>
<li class="chapter" data-level="8.1" data-path="pkr-r-package.html"><a href="pkr-r-package.html#in-this-chapter"><i class="fa fa-check"></i><b>8.1</b> In this chapter</a></li>
<li class="chapter" data-level="8.2" data-path="pkr-r-package.html"><a href="pkr-r-package.html#what-is-ncar-r-package"><i class="fa fa-check"></i><b>8.2</b> What is <code>ncar</code> R package?</a></li>
<li class="chapter" data-level="8.3" data-path="pkr-r-package.html"><a href="pkr-r-package.html#how-does-it-work"><i class="fa fa-check"></i><b>8.3</b> How does it work?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html"><i class="fa fa-check"></i><b>9</b> Comparison of Noncompartmental analysis software</a><ul>
<li class="chapter" data-level="9.1" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#in-this-chapter-1"><i class="fa fa-check"></i><b>9.1</b> In this chapter</a></li>
<li class="chapter" data-level="9.2" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#certara-phoenix-winnonlin"><i class="fa fa-check"></i><b>9.2</b> Certara Phoenix WinNonLin</a><ul>
<li class="chapter" data-level="9.2.1" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#pros"><i class="fa fa-check"></i><b>9.2.1</b> Pros</a></li>
<li class="chapter" data-level="9.2.2" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#cons"><i class="fa fa-check"></i><b>9.2.2</b> Cons</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#r-package-pknca"><i class="fa fa-check"></i><b>9.3</b> R package: PKNCA</a><ul>
<li class="chapter" data-level="9.3.1" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#pros-1"><i class="fa fa-check"></i><b>9.3.1</b> Pros</a></li>
<li class="chapter" data-level="9.3.2" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#cons-1"><i class="fa fa-check"></i><b>9.3.2</b> Cons</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#r-package-ncar"><i class="fa fa-check"></i><b>9.4</b> R package: ncar</a><ul>
<li class="chapter" data-level="9.4.1" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#pros-2"><i class="fa fa-check"></i><b>9.4.1</b> Pros</a></li>
<li class="chapter" data-level="9.4.2" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#cons-2"><i class="fa fa-check"></i><b>9.4.2</b> Cons</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#r-package-ncappc"><i class="fa fa-check"></i><b>9.5</b> R package: ncappc</a></li>
<li class="chapter" data-level="9.6" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#kinetica"><i class="fa fa-check"></i><b>9.6</b> Kinetica</a></li>
<li class="chapter" data-level="9.7" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#pk-module-in-r"><i class="fa fa-check"></i><b>9.7</b> PK module in R</a></li>
<li class="chapter" data-level="9.8" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#scientist"><i class="fa fa-check"></i><b>9.8</b> Scientist</a></li>
<li class="chapter" data-level="9.9" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#pksolver"><i class="fa fa-check"></i><b>9.9</b> PKSolver</a></li>
<li class="chapter" data-level="9.10" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#r-package-pk"><i class="fa fa-check"></i><b>9.10</b> R package: PK</a></li>
<li class="chapter" data-level="9.11" data-path="comparison-of-noncompartmental-analysis-software.html"><a href="comparison-of-noncompartmental-analysis-software.html#summary"><i class="fa fa-check"></i><b>9.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="details.html"><a href="details.html"><i class="fa fa-check"></i><b>10</b> Details</a><ul>
<li class="chapter" data-level="10.1" data-path="details.html"><a href="details.html#in-this-chapter-2"><i class="fa fa-check"></i><b>10.1</b> In this chapter</a></li>
<li class="chapter" data-level="10.2" data-path="details.html"><a href="details.html#ncar"><i class="fa fa-check"></i><b>10.2</b> ncar</a></li>
<li class="chapter" data-level="10.3" data-path="details.html"><a href="details.html#pknca"><i class="fa fa-check"></i><b>10.3</b> PKNCA</a></li>
<li class="chapter" data-level="10.4" data-path="details.html"><a href="details.html#ncappc"><i class="fa fa-check"></i><b>10.4</b> ncappc</a></li>
<li class="chapter" data-level="10.5" data-path="details.html"><a href="details.html#summary-1"><i class="fa fa-check"></i><b>10.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://github.com/asancpt/ncar">ncar Github Repo</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Noncompartmental Analysis by R Packages</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="method" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> 이론 및 계산 방법</h1>
<p>비구획 분석이란 시간, 농도가 표현되어 있는 곡선에서 아무런 가정을 하지 않고 분석하는 것을 의미한다. 이때 다음과 같은 가정을 통해서 최대농도(Cmax) 및 최대농도에 도달하는 시간(Tmax), 전체 시간-농도 곡선의 면적(Area under the time-concentration curve, AUC)등을 구하게 된다. 이를 통해 측정된 지표들을 통하여 약물의 특성을 파악하고 특정구간에서의 농도를 예측하게 된다. 비구획 분석에서는 기본적으로 statistical moment theory (단순히 하나의 분자가 우리 몸에 들어와서 제거되지 까지는 예측하는 것이 힘들지만 그 개개의 분자들의 양이 늘어날수록 그들의 전반적인 행동이 규칙적으로 이루어진다는 이론)를 가정하고 이를 통해 우리는 각각의 분자가 우리 몸에서 얼마나 머무는지에 대한 평균값을 예상할 수 있게 된다. 이 시간을 MRT(mean residence time)이라고 지칭하게 되며, 이것은 농도와 시간의 곱을 적분한 값에서 단순 농도 값을 적분한 농도를 나누어 준 값으로 다음과 같이 표현해 줄 수 있다.</p>
<p>이때 식에서 표현된 AUMC는 area under the first moment curve로 농도와 시간의 곱을 시간에 대해서 적분한 값에 해당하며 AUC는 area under concentration으로 농도를 시간에 대해 적분한 값에 해당한다. 하지만 이 때, 각각의 약물에서 농도와 시간 사이의 명확한 함수관계를 확인할 수 없고, 주어진 정보도 제한적이므로 농도를 시간으로 적분하기에는 상당한 어려움이 따른다. 따라서 이를 간소화 하기 위해 Linear trapezoidal method(농도-시간 곡선에서 농도를 측정한 점과 점 사이의 면적을 사다리꼴이라 가정하고 넓이를 구하는 방식)를 사용하게 된다. 처음 농도를 측정한 부분부터 마지막 샘플까지를 t1,t2 …tlast로 표현했을 시 t1과 t2의 사이의 AUC와 AUMC는 다음과 같이 계산된다</p>
<p>이 방식을 계속 이용하여 각각의 구간 값의 합을 모두 더한 값으로 AUClast(처음 농도를 측정하기 시작한 구간부터 마지막 농도를 측정한 구간까지 linear trapezoidal method를 통해서 값을 계산한 방식), AUMClast(처음 농도를 측정하기 시작한 구간부터 마지막 농도를 측정한 구간까지 linear trapezoidal method를 통해서 값을 계산한 방식)를 측정해 주게 된다.</p>
<p>Figure 1 Linear trapezoidal method 추가적으로 마지막으로 농도를 잰 시점에서 모든 약물이 우리 몸에서 빠져나가는 시점까지의 값을 구하기 위해서 마지막으로 측정한 점의 기울기가 그대로 약물이 모두 제거되는 시점까지 그대로 유지된다는 가정을 세우게 되며, 다음과 같이 Clast(가장 마지막으로 농도를 측정한 시점)에서 λ(Cmax 이후에 선형성이 가장 높은 3점을 선택하여 구한 기울기)를 구한 후</p>
<p>위와 같은 약동학 공식을 대입하여 값을 구해주게 된다.</p>
<p>약물이 우리 몸에 들어온 후 가장 높은 농도의 경우 실제 개개인에서 농도를 측정한 값들 중 가장 높은 농도를 실제 가장 높은 농도라 가정하여 사용하게 되고(이 지표를 Cmax라 지칭한다.), 이 시점을 Tmax라 부르게 된다. 위에서 구한 AUC와 Cmax, λ 를 가지고 나머지 주요 값을 계산하게 된다. 이 중 청소율(제거되는 속도)에 해당하는 clearance(일반적으로 CL이라 지칭한다.) 의 경우 다음의 약동학 기본 공식을 활용하여 구해주게 된다.</p>
<p>(다음 수식에서 D는 dose로 투여량을, F는 생체이용률을 의미한다.) 우리 몸의 분포(disposition)을 알기 위해 우리 몸의 volume을 나타내는 volume of distribution at steady state(Vdss)는 위 공식을 이용하여 값을 추정하게 되고 추가적으로 우리 몸의 생체이용률을 측정하는 F의 경우(기본적으로 정맥주사시의 생체이용률을 1이라고 가정하게 된다.)</p>
<p>다음의 공식을 활용하여 값을 계산한다. (이중 Div는 정맥주사 투여량, Doral은 경구 투여량, AUCoral은 경구 투여에서의 AUC, AUCiv는 정맥투여에서의 AUC를 의미한다. 이처럼 AUC, Cmax, AUMC, λ 를 구하는 부분에 있어서는 non-compartmental analysis의 기본 가정들을 활용하였고 그 밖의 부분들에서는 현재 정형화된 공식들을 활용하여 적용하였다. 위 내용을 바탕으로 R을 기반으로 한 script를 구성한 후 전세계적으로 널리 쓰이고 있는 CDISC terminology를 각각의 지표들에 적용하여 결과값을 도출하였다. 또한 투여되는 방식을 3가지 분류(Extravascular, IV infusion, IV bolus)로 구분하여, 그에 맞는 각각의 식을 적용하였다. 마지막으로 시간당 농도의 변화율이 농도 증가 곡선보다 감소 곡선에서 완만하다는 점을 고려하여 농도가 감소하는 구간에서는 log값을 선택적으로 줄 수 있도록 설정하였으며, 흡수 속도 상수의 경우 현 NCA method를 통해 구하기에는 한계가 있어 따로 값을 제시하지 않았다. 흡수속도 상수를 구하기 위해서는 구획분석방법(compartmental analysis)이나 비선형 혼합모형(non-linear mixed effect modeling)을 사용하는 것이 바람직하다.</p>
<p>Figure 2. Linear trapezoidal method를 적용한 AUC의 계산 Script</p>
<p>Figure 3 약동학 지표들에 대해 각각의 공식을 적용한 Script의 예</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="result.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/asancpt/ncar/edit/master/bookdown/01-intro.Rmd",
"text": "Edit"
},
"download": ["_main.pdf", "_main.epub", "_main.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
