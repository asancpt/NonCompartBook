<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R을 사용한 비구획분석</title>
  <meta name="description" content="이 책은 R 패키지를 사용하여 비구획분석을 쉽게 따라할 수 있도록 쓰여졌습니다. 값비싼 상용소프트웨어와 동일한 결과를 얻으면서, 한번 익혀두면 속도와 연속성 측면에서 잇점이 많은 것을 발견할 수 있을 것입니다. 무엇보다 무료로 사용할 수 있는 R기반의 공개 소프트웨어라는 점에서 많은 연구자 혹은 기관에서 손쉽게 설치하고 실행할 수 있으리라 생각됩니다.">
  <meta name="generator" content="bookdown 0.5.9 and GitBook 2.6.7">

  <meta property="og:title" content="R을 사용한 비구획분석" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://asancpt.github.io/book-ncar/" />
  <meta property="og:image" content="https://asancpt.github.io/book-ncar/assets/cover.jpg" />
  <meta property="og:description" content="이 책은 R 패키지를 사용하여 비구획분석을 쉽게 따라할 수 있도록 쓰여졌습니다. 값비싼 상용소프트웨어와 동일한 결과를 얻으면서, 한번 익혀두면 속도와 연속성 측면에서 잇점이 많은 것을 발견할 수 있을 것입니다. 무엇보다 무료로 사용할 수 있는 R기반의 공개 소프트웨어라는 점에서 많은 연구자 혹은 기관에서 손쉽게 설치하고 실행할 수 있으리라 생각됩니다." />
  <meta name="github-repo" content="asancpt/book-ncar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R을 사용한 비구획분석" />
  
  <meta name="twitter:description" content="이 책은 R 패키지를 사용하여 비구획분석을 쉽게 따라할 수 있도록 쓰여졌습니다. 값비싼 상용소프트웨어와 동일한 결과를 얻으면서, 한번 익혀두면 속도와 연속성 측면에서 잇점이 많은 것을 발견할 수 있을 것입니다. 무엇보다 무료로 사용할 수 있는 R기반의 공개 소프트웨어라는 점에서 많은 연구자 혹은 기관에서 손쉽게 설치하고 실행할 수 있으리라 생각됩니다." />
  <meta name="twitter:image" content="https://asancpt.github.io/book-ncar/assets/cover.jpg" />

<meta name="author" content="배균섭, 한성필, 윤석규, 조용순">


<meta name="date" content="2017-11-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="conclusion.html">
<link rel="next" href="groupreport.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">R을 사용한 비구획분석</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>책 머리에</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i>감사의 글</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i>저자 소개</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> 비구획 분석이란</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#summary-introduction"><i class="fa fa-check"></i><b>1.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#PK-introduction"><i class="fa fa-check"></i><b>1.2</b> 약동학</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#ncar-method"><i class="fa fa-check"></i><b>1.3</b> 비구획 분석 이론 및 계산 방법</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="R-and-packages.html"><a href="R-and-packages.html"><i class="fa fa-check"></i><b>2</b> R과 그 패키지에 대하여</a><ul>
<li class="chapter" data-level="2.1" data-path="R-and-packages.html"><a href="R-and-packages.html#summary-r-packages"><i class="fa fa-check"></i><b>2.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="2.2" data-path="R-and-packages.html"><a href="R-and-packages.html#basic"><i class="fa fa-check"></i><b>2.2</b> R에 대하여</a></li>
<li class="chapter" data-level="2.3" data-path="R-and-packages.html"><a href="R-and-packages.html#install"><i class="fa fa-check"></i><b>2.3</b> 설치</a></li>
<li class="chapter" data-level="2.4" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i><b>2.4</b> 기타 설치</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>3</b> 기본 자료</a><ul>
<li class="chapter" data-level="3.1" data-path="datasets.html"><a href="datasets.html#introdatasets"><i class="fa fa-check"></i><b>3.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="3.2" data-path="datasets.html"><a href="datasets.html#TheophData"><i class="fa fa-check"></i><b>3.2</b> 데이타에 대해</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="noncompart.html"><a href="noncompart.html"><i class="fa fa-check"></i><b>4</b> R을 사용한 비구획분석</a><ul>
<li class="chapter" data-level="4.1" data-path="noncompart.html"><a href="noncompart.html#summary-noncompart"><i class="fa fa-check"></i><b>4.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="4.2" data-path="noncompart.html"><a href="noncompart.html#how-to-use"><i class="fa fa-check"></i><b>4.2</b> NonCompart 사용법</a></li>
<li class="chapter" data-level="4.3" data-path="noncompart.html"><a href="noncompart.html#interval-NCA"><i class="fa fa-check"></i><b>4.3</b> 구간 NCA</a></li>
<li class="chapter" data-level="4.4" data-path="noncompart.html"><a href="noncompart.html#functions"><i class="fa fa-check"></i><b>4.4</b> 함수 살펴보기</a><ul>
<li class="chapter" data-level="4.4.1" data-path="noncompart.html"><a href="noncompart.html#auc"><i class="fa fa-check"></i><b>4.4.1</b> AUC</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="noncompart.html"><a href="noncompart.html#long-format"><i class="fa fa-check"></i><b>4.5</b> 긴 형식으로 변환하면서 단위 추가하기</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ncar.html"><a href="ncar.html"><i class="fa fa-check"></i><b>5</b> R을 사용한 비구획분석 보고서</a><ul>
<li class="chapter" data-level="5.1" data-path="ncar.html"><a href="ncar.html#summary-ncar"><i class="fa fa-check"></i><b>5.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="5.2" data-path="ncar.html"><a href="ncar.html#ncar-"><i class="fa fa-check"></i><b>5.2</b> ncar 사용법</a><ul>
<li class="chapter" data-level="5.2.1" data-path="ncar.html"><a href="ncar.html#txtnca---"><i class="fa fa-check"></i><b>5.2.1</b> txtNCA(): 한 대상자 보고서</a></li>
<li class="chapter" data-level="5.2.2" data-path="ncar.html"><a href="ncar.html#txtnca2---"><i class="fa fa-check"></i><b>5.2.2</b> txtNCA2(): 여러 대상자 보고서</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pkr.html"><a href="pkr.html"><i class="fa fa-check"></i><b>6</b> R을 사용한 비구획분석 시각화</a><ul>
<li class="chapter" data-level="6.1" data-path="pkr.html"><a href="pkr.html#summary-pkr"><i class="fa fa-check"></i><b>6.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="6.2" data-path="pkr.html"><a href="pkr.html#pkr-"><i class="fa fa-check"></i><b>6.2</b> pkr 사용법</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>7</b> R을 사용한 약동학 시뮬레이션</a><ul>
<li class="chapter" data-level="7.1" data-path="simulation.html"><a href="simulation.html#summary-simulation"><i class="fa fa-check"></i><b>7.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="7.2" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i><b>7.2</b> 시뮬레이션에 대하여</a></li>
<li class="chapter" data-level="7.3" data-path="simulation.html"><a href="simulation.html#--"><i class="fa fa-check"></i><b>7.3</b> 시뮬레이션 후 비구획분석</a></li>
<li class="chapter" data-level="7.4" data-path="simulation.html"><a href="simulation.html#---"><i class="fa fa-check"></i><b>7.4</b> 앱을 통해 살펴보는 시뮬레이션</a><ul>
<li class="chapter" data-level="7.4.1" data-path="simulation.html"><a href="simulation.html#shiny-"><i class="fa fa-check"></i><b>7.4.1</b> shiny 앱</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>8</b> 통계처리</a><ul>
<li class="chapter" data-level="8.1" data-path="statistics.html"><a href="statistics.html#stat-intro"><i class="fa fa-check"></i><b>8.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="8.2" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i><b>8.2</b> 기술통계량 구하기</a></li>
<li class="chapter" data-level="8.3" data-path="statistics.html"><a href="statistics.html#bioequivalence"><i class="fa fa-check"></i><b>8.3</b> 생물학적 동등성</a></li>
<li class="chapter" data-level="8.4" data-path="statistics.html"><a href="statistics.html#dp"><i class="fa fa-check"></i><b>8.4</b> Dose Proportionality</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="result.html"><a href="result.html"><i class="fa fa-check"></i><b>9</b> 결과 및 논의</a></li>
<li class="chapter" data-level="10" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>10</b> 결론</a></li>
<li class="appendix"><span><b>부록</b></span></li>
<li class="chapter" data-level="A" data-path="tblnca2.html"><a href="tblnca2.html"><i class="fa fa-check"></i><b>A</b> tblNCA2()</a><ul>
<li class="chapter" data-level="A.1" data-path="tblnca2.html"><a href="tblnca2.html#how-to-include-iauc-in-the-tblnca"><i class="fa fa-check"></i><b>A.1</b> How to include iAUC in the tblNCA</a><ul>
<li class="chapter" data-level="A.1.1" data-path="tblnca2.html"><a href="tblnca2.html#writing-tblnca2"><i class="fa fa-check"></i><b>A.1.1</b> Writing <code>tblNCA2()</code></a></li>
<li class="chapter" data-level="A.1.2" data-path="tblnca2.html"><a href="tblnca2.html#examples"><i class="fa fa-check"></i><b>A.1.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="tblnca2.html"><a href="tblnca2.html#how-to-get-descriptive-statistics"><i class="fa fa-check"></i><b>A.2</b> How to get descriptive statistics</a><ul>
<li class="chapter" data-level="A.2.1" data-path="tblnca2.html"><a href="tblnca2.html#write-your-own-scripts"><i class="fa fa-check"></i><b>A.2.1</b> Write your own scripts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="groupreport.html"><a href="groupreport.html"><i class="fa fa-check"></i><b>B</b> R에 내장된 자료의 비구획분석 보고서</a><ul>
<li class="chapter" data-level="B.1" data-path="groupreport.html"><a href="groupreport.html#theophgroup"><i class="fa fa-check"></i><b>B.1</b> Theoph의 보고서</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="support.html"><a href="support.html"><i class="fa fa-check"></i><b>C</b> 지원</a></li>
<li class="chapter" data-level="D" data-path="session-info.html"><a href="session-info.html"><i class="fa fa-check"></i><b>D</b> 세션 정보</a></li>
<li class="chapter" data-level="" data-path="ecb0b8eab3a0ebacb8ed978c.html"><a href="ecb0b8eab3a0ebacb8ed978c.html"><i class="fa fa-check"></i>참고문헌</a></li>
<li class="divider"></li>
<li><a href="http://github.com/asancpt/book-ncar">book-ncar Github 저장소</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R을 사용한 비구획분석</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tblnca2" class="section level1">
<h1><span class="header-section-number">A</span> tblNCA2()</h1>
<p>This document may be temporarily meaningful because the functionality will be included in <code>NonCompart</code> <span class="citation">(Bae <a href="#ref-R-NonCompart">2017</a><a href="#ref-R-NonCompart">b</a>)</span> package someday as Prof.Bae said. Until then, I hope that these tips can save several minutes (or hours) for a few people.</p>
<p>One thing we should keep in mind is that the output of <code>tblNCA()</code> is a character matrix so we probably want to change it to <strong>data.frame</strong> (or <strong>tibble</strong>) for the further manipulation and the PK parameters should be converted to numeric by <code>as.numeric()</code> to find descriptive statistics.</p>
<p>These R packages are used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(NonCompart) <span class="co"># for tblNCA(), IntAUC()</span>
<span class="kw">library</span>(dplyr) <span class="co"># for data manipulation</span>
<span class="kw">library</span>(tidyr) <span class="co"># for data manipulation</span>
<span class="kw">library</span>(purrr) <span class="co"># for pmap_dbl()</span>
<span class="kw">library</span>(knitr) <span class="co"># make pretty tables (can be ignored when we don&#39;t need them.)</span></code></pre></div>

<div id="how-to-include-iauc-in-the-tblnca" class="section level2">
<h2><span class="header-section-number">A.1</span> How to include iAUC in the tblNCA</h2>
<div id="writing-tblnca2" class="section level3">
<h3><span class="header-section-number">A.1.1</span> Writing <code>tblNCA2()</code></h3>
<p><code>tblNCA2()</code> is a wrapper function of <code>tblNCA()</code> to include iAUC. In the function, iAUC is calculated by <code>IntAUC()</code>. Data manipulation can be done in numerous ways but I prefer using Hadley’s packages for functional programming <span class="citation">(Henry and Wickham <a href="#ref-R-purrr">2017</a>)</span> and tidy data handling <span class="citation">(Wickham and Henry <a href="#ref-R-tidyr">2017</a>; Wickham et al. <a href="#ref-R-dplyr">2017</a>)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tblNCA2 &lt;-<span class="st"> </span><span class="cf">function</span>(concData, <span class="dt">key =</span> <span class="st">&quot;Subject&quot;</span>, 
                    <span class="dt">colTime =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">colConc =</span> <span class="st">&quot;conc&quot;</span>, 
                    <span class="dt">down =</span> <span class="st">&quot;linear&quot;</span>, <span class="dt">t1 =</span> <span class="dv">0</span>, <span class="dt">t2 =</span> <span class="dv">0</span>, ...){
  <span class="co"># tblNCA() and data calculation</span>
  input_tbl &lt;-<span class="st"> </span><span class="kw">tblNCA</span>(<span class="kw">as.data.frame</span>(concData), 
                      key, colTime, colConc, <span class="dt">down =</span> down, ...) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># calculation</span>
<span class="st">    </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_all</span>(as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">left_join</span>(concData <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_all</span>(as.character) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                </span><span class="kw">group_by_</span>(<span class="dt">.dots =</span> key) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># grouping by keys (Subject)</span>
<span class="st">                </span><span class="kw">summarise_</span>(<span class="dt">x =</span> <span class="kw">sprintf</span>(<span class="st">&#39;list(%s)&#39;</span>, colTime), 
                           <span class="dt">y =</span> <span class="kw">sprintf</span>(<span class="st">&#39;list(%s)&#39;</span>, colConc)))
  
  <span class="co"># calculation of IntAUC()</span>
  output &lt;-<span class="st"> </span>input_tbl <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Res =</span> <span class="kw">do.call</span>(c, input_tbl <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>x, <span class="op">-</span>y) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">apply</span>(<span class="dv">1</span>, list))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">iAUC =</span> <span class="kw">pmap_dbl</span>(<span class="dt">.l =</span> <span class="kw">list</span>(x, y, Res), 
                           <span class="dt">.f =</span> <span class="op">~</span><span class="kw">IntAUC</span>(<span class="dt">x =</span> <span class="kw">as.numeric</span>(..<span class="dv">1</span>), <span class="dt">y =</span> <span class="kw">as.numeric</span>(..<span class="dv">2</span>), 
                                        t1, t2, 
                                        <span class="dt">Res =</span> ..<span class="dv">3</span>, <span class="dt">down =</span> down))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>x, <span class="op">-</span>y, <span class="op">-</span>Res) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(b0<span class="op">:</span>iAUC), as.numeric) <span class="co"># character -&gt; number</span>
  <span class="kw">return</span>(output)
}</code></pre></div>
</div>
<div id="examples" class="section level3">
<h3><span class="header-section-number">A.1.2</span> Examples</h3>
<div id="example-1-datasetstheoph" class="section level4">
<h4><span class="header-section-number">A.1.2.1</span> Example 1: datasets::Theoph</h4>
<p>Now we can use <code>tblNCA2()</code> to find NCA parameters and <em>interval AUC between 0-12 hours</em> of Theoph dataset internally available in R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Theoph_with_iAUC &lt;-<span class="st"> </span><span class="kw">tblNCA2</span>(Theoph, <span class="dt">dose =</span> <span class="dv">320</span>, <span class="dt">t1 =</span> <span class="dv">0</span>, <span class="dt">t2 =</span> <span class="dv">12</span>) <span class="co"># 0-12h</span>
Theoph_with_iAUC <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&#39;Entire PK parameters calculated by NonCompart&#39;</span>, <span class="dt">booktabs=</span><span class="ot">TRUE</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<table>
<caption><span id="tab:wide">Table A.1: </span>Entire PK parameters calculated by NonCompart</caption>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">b0</th>
<th align="right">CMAX</th>
<th align="right">CMAXD</th>
<th align="right">TMAX</th>
<th align="right">TLAG</th>
<th align="right">CLST</th>
<th align="right">CLSTP</th>
<th align="right">TLST</th>
<th align="right">LAMZHL</th>
<th align="right">LAMZ</th>
<th align="right">LAMZLL</th>
<th align="right">LAMZUL</th>
<th align="right">LAMZNPT</th>
<th align="right">CORRXY</th>
<th align="right">R2</th>
<th align="right">R2ADJ</th>
<th align="right">AUCLST</th>
<th align="right">AUCALL</th>
<th align="right">AUCIFO</th>
<th align="right">AUCIFOD</th>
<th align="right">AUCIFP</th>
<th align="right">AUCIFPD</th>
<th align="right">AUCPEO</th>
<th align="right">AUCPEP</th>
<th align="right">AUMCLST</th>
<th align="right">AUMCIFO</th>
<th align="right">AUMCIFP</th>
<th align="right">AUMCPEO</th>
<th align="right">AUMCPEP</th>
<th align="right">VZFO</th>
<th align="right">VZFP</th>
<th align="right">CLFO</th>
<th align="right">CLFP</th>
<th align="right">MRTEVLST</th>
<th align="right">MRTEVIFO</th>
<th align="right">MRTEVIFP</th>
<th align="right">iAUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">2.37</td>
<td align="right">10.50</td>
<td align="right">0.03</td>
<td align="right">1.12</td>
<td align="right">0</td>
<td align="right">3.28</td>
<td align="right">3.28</td>
<td align="right">24.37</td>
<td align="right">14.30</td>
<td align="right">0.05</td>
<td align="right">9.05</td>
<td align="right">24.37</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">148.92</td>
<td align="right">148.92</td>
<td align="right">216.61</td>
<td align="right">0.68</td>
<td align="right">216.61</td>
<td align="right">0.68</td>
<td align="right">31.25</td>
<td align="right">31.25</td>
<td align="right">1459.07</td>
<td align="right">4505.53</td>
<td align="right">4505.67</td>
<td align="right">67.62</td>
<td align="right">67.62</td>
<td align="right">30486.75</td>
<td align="right">30486.32</td>
<td align="right">1477.30</td>
<td align="right">1477.28</td>
<td align="right">9.80</td>
<td align="right">20.80</td>
<td align="right">20.80</td>
<td align="right">91.74</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">2.41</td>
<td align="right">8.33</td>
<td align="right">0.03</td>
<td align="right">1.92</td>
<td align="right">0</td>
<td align="right">0.90</td>
<td align="right">0.89</td>
<td align="right">24.30</td>
<td align="right">6.66</td>
<td align="right">0.10</td>
<td align="right">7.03</td>
<td align="right">24.30</td>
<td align="right">4</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">91.53</td>
<td align="right">91.53</td>
<td align="right">100.17</td>
<td align="right">0.31</td>
<td align="right">100.06</td>
<td align="right">0.31</td>
<td align="right">8.63</td>
<td align="right">8.53</td>
<td align="right">706.59</td>
<td align="right">999.77</td>
<td align="right">996.07</td>
<td align="right">29.33</td>
<td align="right">29.06</td>
<td align="right">30690.44</td>
<td align="right">30723.92</td>
<td align="right">3194.46</td>
<td align="right">3197.94</td>
<td align="right">7.72</td>
<td align="right">9.98</td>
<td align="right">9.95</td>
<td align="right">67.48</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">2.53</td>
<td align="right">8.20</td>
<td align="right">0.03</td>
<td align="right">1.02</td>
<td align="right">0</td>
<td align="right">1.05</td>
<td align="right">1.06</td>
<td align="right">24.17</td>
<td align="right">6.77</td>
<td align="right">0.10</td>
<td align="right">9.00</td>
<td align="right">24.17</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">99.29</td>
<td align="right">99.29</td>
<td align="right">109.54</td>
<td align="right">0.34</td>
<td align="right">109.59</td>
<td align="right">0.34</td>
<td align="right">9.36</td>
<td align="right">9.40</td>
<td align="right">803.19</td>
<td align="right">1150.96</td>
<td align="right">1152.65</td>
<td align="right">30.22</td>
<td align="right">30.32</td>
<td align="right">28517.10</td>
<td align="right">28504.15</td>
<td align="right">2921.41</td>
<td align="right">2920.09</td>
<td align="right">8.09</td>
<td align="right">10.51</td>
<td align="right">10.52</td>
<td align="right">70.18</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">2.59</td>
<td align="right">8.60</td>
<td align="right">0.03</td>
<td align="right">1.07</td>
<td align="right">0</td>
<td align="right">1.15</td>
<td align="right">1.16</td>
<td align="right">24.65</td>
<td align="right">6.98</td>
<td align="right">0.10</td>
<td align="right">9.02</td>
<td align="right">24.65</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">106.80</td>
<td align="right">106.80</td>
<td align="right">118.38</td>
<td align="right">0.37</td>
<td align="right">118.44</td>
<td align="right">0.37</td>
<td align="right">9.78</td>
<td align="right">9.83</td>
<td align="right">901.08</td>
<td align="right">1303.25</td>
<td align="right">1305.50</td>
<td align="right">30.86</td>
<td align="right">30.98</td>
<td align="right">27225.96</td>
<td align="right">27211.10</td>
<td align="right">2703.18</td>
<td align="right">2701.71</td>
<td align="right">8.44</td>
<td align="right">11.01</td>
<td align="right">11.02</td>
<td align="right">73.05</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">2.55</td>
<td align="right">11.40</td>
<td align="right">0.04</td>
<td align="right">1.00</td>
<td align="right">0</td>
<td align="right">1.57</td>
<td align="right">1.56</td>
<td align="right">24.35</td>
<td align="right">8.00</td>
<td align="right">0.09</td>
<td align="right">7.02</td>
<td align="right">24.35</td>
<td align="right">4</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">121.29</td>
<td align="right">121.29</td>
<td align="right">139.42</td>
<td align="right">0.44</td>
<td align="right">139.25</td>
<td align="right">0.44</td>
<td align="right">13.00</td>
<td align="right">12.90</td>
<td align="right">1017.11</td>
<td align="right">1667.72</td>
<td align="right">1661.79</td>
<td align="right">39.01</td>
<td align="right">38.79</td>
<td align="right">26497.99</td>
<td align="right">26529.42</td>
<td align="right">2295.23</td>
<td align="right">2297.95</td>
<td align="right">8.39</td>
<td align="right">11.96</td>
<td align="right">11.93</td>
<td align="right">84.61</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">2.03</td>
<td align="right">6.44</td>
<td align="right">0.02</td>
<td align="right">1.15</td>
<td align="right">0</td>
<td align="right">0.92</td>
<td align="right">0.94</td>
<td align="right">23.85</td>
<td align="right">7.89</td>
<td align="right">0.09</td>
<td align="right">2.03</td>
<td align="right">23.85</td>
<td align="right">7</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">73.78</td>
<td align="right">73.78</td>
<td align="right">84.25</td>
<td align="right">0.26</td>
<td align="right">84.50</td>
<td align="right">0.26</td>
<td align="right">12.44</td>
<td align="right">12.69</td>
<td align="right">609.15</td>
<td align="right">978.43</td>
<td align="right">986.97</td>
<td align="right">37.74</td>
<td align="right">38.28</td>
<td align="right">43259.73</td>
<td align="right">43135.69</td>
<td align="right">3798.02</td>
<td align="right">3787.13</td>
<td align="right">8.26</td>
<td align="right">11.61</td>
<td align="right">11.68</td>
<td align="right">51.76</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">2.29</td>
<td align="right">7.09</td>
<td align="right">0.02</td>
<td align="right">3.48</td>
<td align="right">0</td>
<td align="right">1.15</td>
<td align="right">1.16</td>
<td align="right">24.22</td>
<td align="right">7.85</td>
<td align="right">0.09</td>
<td align="right">6.98</td>
<td align="right">24.22</td>
<td align="right">4</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">90.75</td>
<td align="right">90.75</td>
<td align="right">103.77</td>
<td align="right">0.32</td>
<td align="right">103.89</td>
<td align="right">0.32</td>
<td align="right">12.55</td>
<td align="right">12.65</td>
<td align="right">782.42</td>
<td align="right">1245.10</td>
<td align="right">1249.41</td>
<td align="right">37.16</td>
<td align="right">37.38</td>
<td align="right">34908.44</td>
<td align="right">34867.67</td>
<td align="right">3083.69</td>
<td align="right">3080.09</td>
<td align="right">8.62</td>
<td align="right">12.00</td>
<td align="right">12.03</td>
<td align="right">62.10</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">2.17</td>
<td align="right">7.56</td>
<td align="right">0.02</td>
<td align="right">2.02</td>
<td align="right">0</td>
<td align="right">1.25</td>
<td align="right">1.23</td>
<td align="right">24.12</td>
<td align="right">8.51</td>
<td align="right">0.08</td>
<td align="right">3.53</td>
<td align="right">24.12</td>
<td align="right">6</td>
<td align="right">-1</td>
<td align="right">0.99</td>
<td align="right">0.99</td>
<td align="right">88.56</td>
<td align="right">88.56</td>
<td align="right">103.91</td>
<td align="right">0.32</td>
<td align="right">103.64</td>
<td align="right">0.32</td>
<td align="right">14.77</td>
<td align="right">14.55</td>
<td align="right">739.53</td>
<td align="right">1298.12</td>
<td align="right">1288.52</td>
<td align="right">43.03</td>
<td align="right">42.61</td>
<td align="right">37810.51</td>
<td align="right">37906.69</td>
<td align="right">3079.69</td>
<td align="right">3087.52</td>
<td align="right">8.35</td>
<td align="right">12.49</td>
<td align="right">12.43</td>
<td align="right">62.71</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="right">2.12</td>
<td align="right">9.03</td>
<td align="right">0.03</td>
<td align="right">0.63</td>
<td align="right">0</td>
<td align="right">1.12</td>
<td align="right">1.12</td>
<td align="right">24.43</td>
<td align="right">8.41</td>
<td align="right">0.08</td>
<td align="right">8.80</td>
<td align="right">24.43</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">86.33</td>
<td align="right">86.33</td>
<td align="right">99.91</td>
<td align="right">0.31</td>
<td align="right">99.87</td>
<td align="right">0.31</td>
<td align="right">13.59</td>
<td align="right">13.56</td>
<td align="right">705.23</td>
<td align="right">1201.77</td>
<td align="right">1200.21</td>
<td align="right">41.32</td>
<td align="right">41.24</td>
<td align="right">38842.79</td>
<td align="right">38859.38</td>
<td align="right">3202.92</td>
<td align="right">3204.29</td>
<td align="right">8.17</td>
<td align="right">12.03</td>
<td align="right">12.02</td>
<td align="right">60.12</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="right">2.66</td>
<td align="right">10.21</td>
<td align="right">0.03</td>
<td align="right">3.55</td>
<td align="right">0</td>
<td align="right">2.42</td>
<td align="right">2.41</td>
<td align="right">23.70</td>
<td align="right">9.25</td>
<td align="right">0.07</td>
<td align="right">9.38</td>
<td align="right">23.70</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">138.37</td>
<td align="right">138.37</td>
<td align="right">170.65</td>
<td align="right">0.53</td>
<td align="right">170.57</td>
<td align="right">0.53</td>
<td align="right">18.92</td>
<td align="right">18.88</td>
<td align="right">1278.18</td>
<td align="right">2473.99</td>
<td align="right">2470.88</td>
<td align="right">48.34</td>
<td align="right">48.27</td>
<td align="right">25015.54</td>
<td align="right">25027.88</td>
<td align="right">1875.16</td>
<td align="right">1876.09</td>
<td align="right">9.24</td>
<td align="right">14.50</td>
<td align="right">14.49</td>
<td align="right">90.82</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="right">2.15</td>
<td align="right">8.00</td>
<td align="right">0.02</td>
<td align="right">0.98</td>
<td align="right">0</td>
<td align="right">0.86</td>
<td align="right">0.86</td>
<td align="right">24.08</td>
<td align="right">7.26</td>
<td align="right">0.10</td>
<td align="right">9.03</td>
<td align="right">24.08</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">80.09</td>
<td align="right">80.09</td>
<td align="right">89.10</td>
<td align="right">0.28</td>
<td align="right">89.10</td>
<td align="right">0.28</td>
<td align="right">10.11</td>
<td align="right">10.11</td>
<td align="right">617.24</td>
<td align="right">928.56</td>
<td align="right">928.49</td>
<td align="right">33.53</td>
<td align="right">33.52</td>
<td align="right">37622.19</td>
<td align="right">37623.04</td>
<td align="right">3591.36</td>
<td align="right">3591.44</td>
<td align="right">7.71</td>
<td align="right">10.42</td>
<td align="right">10.42</td>
<td align="right">58.54</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="right">2.82</td>
<td align="right">9.75</td>
<td align="right">0.03</td>
<td align="right">3.52</td>
<td align="right">0</td>
<td align="right">1.17</td>
<td align="right">1.18</td>
<td align="right">24.15</td>
<td align="right">6.29</td>
<td align="right">0.11</td>
<td align="right">9.03</td>
<td align="right">24.15</td>
<td align="right">3</td>
<td align="right">-1</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">119.98</td>
<td align="right">119.98</td>
<td align="right">130.59</td>
<td align="right">0.41</td>
<td align="right">130.64</td>
<td align="right">0.41</td>
<td align="right">8.13</td>
<td align="right">8.16</td>
<td align="right">977.88</td>
<td align="right">1330.38</td>
<td align="right">1332.05</td>
<td align="right">26.50</td>
<td align="right">26.59</td>
<td align="right">22224.29</td>
<td align="right">22215.75</td>
<td align="right">2450.44</td>
<td align="right">2449.50</td>
<td align="right">8.15</td>
<td align="right">10.19</td>
<td align="right">10.20</td>
<td align="right">85.02</td>
</tr>
</tbody>
</table>
<p>Table <a href="tblnca2.html#tab:wide">A.1</a> is so wide that we may want to focus on C<sub>max</sub>, T<sub>max</sub>, AUC<sub>last</sub>, AUC<sub>inf</sub>, and iAUC. Table <a href="tblnca2.html#tab:pkparam">A.2</a> looks okay. We can compare the values with the concentration-time curves in Figure <a href="tblnca2.html#fig:ggfig">A.1</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Theoph_with_iAUC_selected &lt;-<span class="st"> </span>Theoph_with_iAUC <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(Subject, CMAX, TMAX, AUCLST, AUCIFO, iAUC) 

Theoph_with_iAUC_selected <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&#39;Selected PK parameters including iAUC&#39;</span>, <span class="dt">booktabs=</span><span class="ot">TRUE</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<table>
<caption><span id="tab:pkparam">Table A.2: </span>Selected PK parameters including iAUC</caption>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">CMAX</th>
<th align="right">TMAX</th>
<th align="right">AUCLST</th>
<th align="right">AUCIFO</th>
<th align="right">iAUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">10.50</td>
<td align="right">1.12</td>
<td align="right">148.92</td>
<td align="right">216.61</td>
<td align="right">91.74</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">8.33</td>
<td align="right">1.92</td>
<td align="right">91.53</td>
<td align="right">100.17</td>
<td align="right">67.48</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">8.20</td>
<td align="right">1.02</td>
<td align="right">99.29</td>
<td align="right">109.54</td>
<td align="right">70.18</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">8.60</td>
<td align="right">1.07</td>
<td align="right">106.80</td>
<td align="right">118.38</td>
<td align="right">73.05</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">11.40</td>
<td align="right">1.00</td>
<td align="right">121.29</td>
<td align="right">139.42</td>
<td align="right">84.61</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">6.44</td>
<td align="right">1.15</td>
<td align="right">73.78</td>
<td align="right">84.25</td>
<td align="right">51.76</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">7.09</td>
<td align="right">3.48</td>
<td align="right">90.75</td>
<td align="right">103.77</td>
<td align="right">62.10</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">7.56</td>
<td align="right">2.02</td>
<td align="right">88.56</td>
<td align="right">103.91</td>
<td align="right">62.71</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="right">9.03</td>
<td align="right">0.63</td>
<td align="right">86.33</td>
<td align="right">99.91</td>
<td align="right">60.12</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="right">10.21</td>
<td align="right">3.55</td>
<td align="right">138.37</td>
<td align="right">170.65</td>
<td align="right">90.82</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="right">8.00</td>
<td align="right">0.98</td>
<td align="right">80.09</td>
<td align="right">89.10</td>
<td align="right">58.54</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="right">9.75</td>
<td align="right">3.52</td>
<td align="right">119.98</td>
<td align="right">130.59</td>
<td align="right">85.02</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(Theoph <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(Theoph_with_iAUC), <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> conc)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&#39;red&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;Subject %2s,Cmax %0.1f,</span><span class="ch">\n</span><span class="st">AUClast %0.1f,iAUC %0.1f&#39;</span>, 
                       Subject, CMAX, AUCLST, iAUC), <span class="dt">ncol =</span> <span class="dv">4</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>()</code></pre></div>
<div class="figure"><span id="fig:ggfig"></span>
<img src="12-tblNCA2_files/figure-html/ggfig-1.png" alt="Individual concentration-time curves" width="672" />
<p class="caption">
Figure A.1: Individual concentration-time curves
</p>
</div>
</div>
<div id="example-2-pkpddatasetssd_oral_richpk" class="section level4">
<h4><span class="header-section-number">A.1.2.2</span> Example 2: PKPDdatasets::sd_oral_richpk</h4>
<p><code>PKPDdatasets</code> package <span class="citation">(Pastoor <a href="#ref-R-PKPDdatasets">2014</a>)</span> contains some interesting PK/PD datasets and I want to apply <code>tblNCA2()</code> to one of them. In this case, I’ll add some more <em>keys</em> such as gender and race. Factors should be converted to characters and <em>strangely</em> the lower case should be avoided as a input of keys in <code>tblNCA()</code>. Table <a href="tblnca2.html#tab:sdoral">A.3</a> shows the results and multiple keys are working fine. Results of only 10 subjects are shown here out of total 50 subjects.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sd_oral_richpk_char &lt;-<span class="st"> </span>PKPDdatasets<span class="op">::</span>sd_oral_richpk <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(ID <span class="op">&lt;=</span><span class="st"> </span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(ID, Gender, Race), <span class="cf">function</span>(x) <span class="kw">toupper</span>(<span class="kw">as.character</span>(x)))

<span class="kw">tblNCA2</span>(sd_oral_richpk_char, 
        <span class="dt">key =</span> <span class="kw">c</span>(<span class="st">&#39;ID&#39;</span>, <span class="st">&#39;Gender&#39;</span>, <span class="st">&#39;Race&#39;</span>), <span class="st">&#39;Time&#39;</span>, <span class="st">&#39;Conc&#39;</span>, <span class="dt">dose =</span> <span class="dv">5000</span>, <span class="dt">t1 =</span> <span class="dv">0</span>, <span class="dt">t2 =</span> <span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(ID, Gender, Race, CMAX, TMAX, AUCLST, AUCIFO, iAUC) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&#39;Selected PK parameters including iAUC of sd oral richpk&#39;</span>, 
        <span class="dt">booktabs=</span><span class="ot">TRUE</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<table>
<caption><span id="tab:sdoral">Table A.3: </span>Selected PK parameters including iAUC of sd oral richpk</caption>
<thead>
<tr class="header">
<th align="left">ID</th>
<th align="left">Gender</th>
<th align="left">Race</th>
<th align="right">CMAX</th>
<th align="right">TMAX</th>
<th align="right">AUCLST</th>
<th align="right">AUCIFO</th>
<th align="right">iAUC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">MALE</td>
<td align="left">HISPANIC</td>
<td align="right">34.01</td>
<td align="right">1</td>
<td align="right">385.58</td>
<td align="right">449.44</td>
<td align="right">280.59</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">MALE</td>
<td align="left">CAUCASIAN</td>
<td align="right">100.18</td>
<td align="right">2</td>
<td align="right">1203.49</td>
<td align="right">2495.10</td>
<td align="right">732.30</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">MALE</td>
<td align="left">OTHER</td>
<td align="right">53.86</td>
<td align="right">3</td>
<td align="right">466.31</td>
<td align="right">481.99</td>
<td align="right">389.24</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">FEMALE</td>
<td align="left">CAUCASIAN</td>
<td align="right">96.68</td>
<td align="right">4</td>
<td align="right">1219.64</td>
<td align="right">1789.21</td>
<td align="right">775.31</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">FEMALE</td>
<td align="left">CAUCASIAN</td>
<td align="right">51.63</td>
<td align="right">2</td>
<td align="right">487.57</td>
<td align="right">516.44</td>
<td align="right">385.18</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">MALE</td>
<td align="left">HISPANIC</td>
<td align="right">27.94</td>
<td align="right">4</td>
<td align="right">295.25</td>
<td align="right">342.57</td>
<td align="right">208.93</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">MALE</td>
<td align="left">OTHER</td>
<td align="right">71.81</td>
<td align="right">4</td>
<td align="right">739.03</td>
<td align="right">876.99</td>
<td align="right">521.99</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">MALE</td>
<td align="left">ASIAN</td>
<td align="right">44.45</td>
<td align="right">3</td>
<td align="right">453.77</td>
<td align="right">472.76</td>
<td align="right">345.15</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">FEMALE</td>
<td align="left">OTHER</td>
<td align="right">48.47</td>
<td align="right">4</td>
<td align="right">698.99</td>
<td align="right">817.67</td>
<td align="right">435.38</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">MALE</td>
<td align="left">OTHER</td>
<td align="right">23.52</td>
<td align="right">2</td>
<td align="right">161.45</td>
<td align="right">162.89</td>
<td align="right">146.59</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">MALE</td>
<td align="left">ASIAN</td>
<td align="right">68.10</td>
<td align="right">6</td>
<td align="right">962.56</td>
<td align="right">1272.65</td>
<td align="right">611.06</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">MALE</td>
<td align="left">OTHER</td>
<td align="right">83.63</td>
<td align="right">2</td>
<td align="right">721.85</td>
<td align="right">768.82</td>
<td align="right">550.52</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="how-to-get-descriptive-statistics" class="section level2">
<h2><span class="header-section-number">A.2</span> How to get descriptive statistics</h2>
<p>You may want to use <code>psych::describe()</code> or <code>broom::tidy()</code> <span class="citation">(Robinson <a href="#ref-R-broom">2016</a>)</span>. They returns basically the same results. One thing to be mentioned is that <code>broom::tidy()</code> returns the descriptive statistics when the input is data.frame so <code>as.data.frame()</code> should be first applied to the output of <code>tblNCA()</code>. (Table <a href="tblnca2.html#tab:descstat-iauc">A.4</a>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">broom<span class="op">::</span><span class="kw">tidy</span>(<span class="kw">as.data.frame</span>(Theoph_with_iAUC_selected)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&#39;Descriptive statistics of selected PK parameters of Theoph&#39;</span>,
        <span class="dt">booktabs =</span> <span class="ot">TRUE</span>, <span class="dt">digits =</span> <span class="dv">2</span>)</code></pre></div>
<table>
<caption><span id="tab:descstat-iauc">Table A.4: </span>Descriptive statistics of selected PK parameters of Theoph</caption>
<thead>
<tr class="header">
<th align="left">column</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">median</th>
<th align="right">trimmed</th>
<th align="right">mad</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">range</th>
<th align="right">skew</th>
<th align="right">kurtosis</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Subject*</td>
<td align="right">12</td>
<td align="right">6.50</td>
<td align="right">3.61</td>
<td align="right">6.50</td>
<td align="right">6.50</td>
<td align="right">4.45</td>
<td align="right">1.00</td>
<td align="right">12.00</td>
<td align="right">11.00</td>
<td align="right">0.00</td>
<td align="right">-1.50</td>
<td align="right">1.04</td>
</tr>
<tr class="even">
<td align="left">CMAX</td>
<td align="right">12</td>
<td align="right">8.76</td>
<td align="right">1.47</td>
<td align="right">8.46</td>
<td align="right">8.73</td>
<td align="right">1.62</td>
<td align="right">6.44</td>
<td align="right">11.40</td>
<td align="right">4.96</td>
<td align="right">0.21</td>
<td align="right">-1.19</td>
<td align="right">0.43</td>
</tr>
<tr class="odd">
<td align="left">TMAX</td>
<td align="right">12</td>
<td align="right">1.79</td>
<td align="right">1.11</td>
<td align="right">1.14</td>
<td align="right">1.73</td>
<td align="right">0.49</td>
<td align="right">0.63</td>
<td align="right">3.55</td>
<td align="right">2.92</td>
<td align="right">0.70</td>
<td align="right">-1.35</td>
<td align="right">0.32</td>
</tr>
<tr class="even">
<td align="left">AUCLST</td>
<td align="right">12</td>
<td align="right">103.81</td>
<td align="right">23.65</td>
<td align="right">95.41</td>
<td align="right">102.30</td>
<td align="right">19.79</td>
<td align="right">73.78</td>
<td align="right">148.92</td>
<td align="right">75.15</td>
<td align="right">0.56</td>
<td align="right">-1.12</td>
<td align="right">6.83</td>
</tr>
<tr class="odd">
<td align="left">AUCIFO</td>
<td align="right">12</td>
<td align="right">122.19</td>
<td align="right">38.13</td>
<td align="right">106.72</td>
<td align="right">116.54</td>
<td align="right">21.70</td>
<td align="right">84.25</td>
<td align="right">216.61</td>
<td align="right">132.36</td>
<td align="right">1.25</td>
<td align="right">0.51</td>
<td align="right">11.01</td>
</tr>
<tr class="even">
<td align="left">iAUC</td>
<td align="right">12</td>
<td align="right">71.51</td>
<td align="right">13.52</td>
<td align="right">68.83</td>
<td align="right">71.46</td>
<td align="right">14.08</td>
<td align="right">51.76</td>
<td align="right">91.74</td>
<td align="right">39.98</td>
<td align="right">0.24</td>
<td align="right">-1.55</td>
<td align="right">3.90</td>
</tr>
</tbody>
</table>
<div id="write-your-own-scripts" class="section level3">
<h3><span class="header-section-number">A.2.1</span> Write your own scripts</h3>
<p>You can write some codes to customize the descriptive statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Theoph_tblNCA &lt;-<span class="st"> </span><span class="kw">tblNCA</span>(Theoph)

<span class="kw">as_tibble</span>(Theoph_tblNCA) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(PPTESTCD, PPORRES, <span class="op">-</span>Subject) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(<span class="kw">tibble</span>(<span class="dt">PPTESTCD =</span> <span class="kw">attr</span>(Theoph_tblNCA, <span class="st">&#39;dimnames&#39;</span>)[[<span class="dv">2</span>]], 
                   <span class="dt">UNIT =</span> <span class="kw">attr</span>(Theoph_tblNCA, <span class="st">&#39;units&#39;</span>)),
          <span class="dt">by =</span> <span class="st">&#39;PPTESTCD&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PPORRES =</span> <span class="kw">as.numeric</span>(PPORRES)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(PPTESTCD, UNIT) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(PPORRES), <span class="kw">funs</span>(<span class="kw">n</span>(), mean, sd, <span class="dt">cv =</span> sd<span class="op">/</span>mean<span class="op">*</span><span class="dv">100</span>,
                                   <span class="dt">geomean =</span> PKNCA<span class="op">::</span>geomean, 
                                   <span class="dt">geosd =</span> PKNCA<span class="op">::</span>geosd, 
                                   <span class="dt">geocv =</span> PKNCA<span class="op">::</span>geocv,
                                   median, min, max)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Arithmetic mean ± SD (CV%)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;%0.1f ± %0.1f (%0.1f%%)&#39;</span>, mean, sd, cv)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Geometric mean ± SD (CV%)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;%0.1f ± %0.1f (%0.1f%%)&#39;</span>, geomean, geosd, geocv)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Median [range]</span><span class="st">`</span> =<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&#39;%0.1f [%0.1f-%0.1f]&#39;</span>, median, min, max)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>mean, <span class="op">-</span>sd, <span class="op">-</span>cv, <span class="op">-</span>geomean, <span class="op">-</span>geosd, <span class="op">-</span>geocv, <span class="op">-</span>median, <span class="op">-</span>min, <span class="op">-</span>max) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(PPTESTCD <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;CMAX&#39;</span>, <span class="st">&#39;TMAX&#39;</span>, <span class="st">&#39;AUCLST&#39;</span>, <span class="st">&#39;AUCIFO&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&#39;Descriptive statistics of selected PK parameters manually calculated.&#39;</span>, 
        <span class="dt">booktabs =</span> <span class="ot">TRUE</span>) </code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-2">Table A.5: </span>Descriptive statistics of selected PK parameters manually calculated.</caption>
<thead>
<tr class="header">
<th align="left">PPTESTCD</th>
<th align="left">UNIT</th>
<th align="right">n</th>
<th>Arithmetic mean ± SD (CV%) G</th>
<th>eometric mean ± SD (CV%) Me</th>
<th align="left">dian [range]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AUCIFO</td>
<td align="left">h*ug/L</td>
<td align="right">12</td>
<td>122.2 ± 38.1 (31.2%) 1</td>
<td>17.7 ± 1.3 (28.0%) 10</td>
<td align="left">6.7 [84.3-216.6]</td>
</tr>
<tr class="even">
<td align="left">AUCLST</td>
<td align="left">h*ug/L</td>
<td align="right">12</td>
<td>103.8 ± 23.6 (22.8%) 1</td>
<td>01.5 ± 1.2 (22.3%) 95</td>
<td align="left">.4 [73.8-148.9]</td>
</tr>
<tr class="odd">
<td align="left">CMAX</td>
<td align="left">ug/L</td>
<td align="right">12</td>
<td>8.8 ± 1.5 (16.8%) 8</td>
<td>.6 ± 1.2 (17.0%) 8.</td>
<td align="left">5 [6.4-11.4]</td>
</tr>
<tr class="even">
<td align="left">TMAX</td>
<td align="left">h</td>
<td align="right">12</td>
<td>1.8 ± 1.1 (62.2%) 1</td>
<td>.5 ± 1.8 (64.7%) 1.</td>
<td align="left">1 [0.6-3.5]</td>
</tr>
</tbody>
</table>
<p>Although there’s an advantage of customization, the script is quite lengthy, so if you’re not preparing a journal paper, I’ll just use <code>broom::tidy()</code>.</p>


</div>
</div>
</div>
<h3>참고문헌</h3>
<div id="refs" class="references">
<div id="ref-R-NonCompart">
<p>Bae, Kyun-Seop. 2017b. <em>NonCompart: Noncompartmental Analysis for Pharmacokinetic Data</em>. <a href="https://CRAN.R-project.org/package=NonCompart" class="uri">https://CRAN.R-project.org/package=NonCompart</a>.</p>
</div>
<div id="ref-R-purrr">
<p>Henry, Lionel, and Hadley Wickham. 2017. <em>Purrr: Functional Programming Tools</em>. <a href="https://CRAN.R-project.org/package=purrr" class="uri">https://CRAN.R-project.org/package=purrr</a>.</p>
</div>
<div id="ref-R-tidyr">
<p>Wickham, Hadley, and Lionel Henry. 2017. <em>Tidyr: Easily Tidy Data with ’Spread()’ and ’Gather()’ Functions</em>. <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a>.</p>
</div>
<div id="ref-R-dplyr">
<p>Wickham, Hadley, Romain Francois, Lionel Henry, and Kirill Muller. 2017. <em>Dplyr: A Grammar of Data Manipulation</em>.</p>
</div>
<div id="ref-R-PKPDdatasets">
<p>Pastoor, Devin. 2014. <em>PKPDdatasets: Data Sets for Pharmacometric Analysis and Visualization</em>.</p>
</div>
<div id="ref-R-broom">
<p>Robinson, David. 2016. <em>Broom: Convert Statistical Analysis Objects into Tidy Data Frames</em>. <a href="http://github.com/tidyverse/broom" class="uri">http://github.com/tidyverse/broom</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="conclusion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="groupreport.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/asancpt/book-ncar/edit/master/12-tblNCA2.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
