[
["index.html", "Noncompartmental Analysis by R Packages 책 머리에 요약", " Noncompartmental Analysis by R Packages Kyun-Seop Bae Sungpil Han Seok Kyu Yoon Yong-Soon Cho 2017-04-17 책 머리에 이 책은 R 패키지를 사용하여 비구획분석을 쉽게 따라할 수 있도록 쓰여졌습니다. 값비싼 상용소프트웨어와 동일한 결과를 얻으면서, 한번 익혀두면 속도와 연속성 측면에서 잇점이 많은 것을 발견할 수 있을 것입니다. 무엇보다 무료 공개소프트웨어라는 점에서 많은 기관에서 손쉽게 접하고 설치할 수 있으리라 생각됩니다. 2017년 3월, 서울아산병원 임상약리학과 교수 배균섭, 전공의 한성필, 윤석규, 조용순 Book cover 요약 약동학 지표를 구할 시 활용되는 비구획 분석을 R pacakge에서 적용하여 테오필린(Theophylline)과 인도메타신(Indomethacin) 데이터에 대한 분석을 실시하였다. 각각의 데이터에 대해 Edison 엡 내에서 농도-시간 곡선에 대한 그래프를 다양한 방식으로 구현할 수 있었으며, 계획한 R script를 통해 도출된 결과에서도 현재 임상적으로 가장 널리 쓰이는 비구획 분석방법 소프트웨어와 동일한 값임을 확인하였다. 또한 실제 비구획 분석보다 한 단계 더 복잡한 분석에 대해서도 실제 구현 가능함을 확인하였다. 이를 통해 앞으로 다양한 약동학적 분석방법을 Edison system 안에서 구현하고 활용할 수 있을 것으로 기대된다. "],
["introduction.html", "Chapter 1 서론", " Chapter 1 서론 신체에서 약물이 들어올 때, 약물의 양과 효과는 관련성이 있으며, 따라서 약물의 효과를 파악하기 위해 우리 몸에서 약물이 가지는 약동학적 특성을 파악하는 것은 굉장히 중요하다. 다양한 신약 개발 과정에서 이러한 약동학적 특성을 파악하여, 약물의 개발을 지속하거나 중지하기도 하며, 마취통증의학과나 내과 등의 다양한 임상 의학에서도 신체에 중요 영향을 미칠 수 있는 약물에 대하여 대략적인 농도를 파악하기 위해 약물의 약동학적 특성을 이용한다. 이러한 약동학적 약물의 특성은 간단하게 ADME라는 용어로 설명할 수 있는데 이는 absorption (흡수), distribution(분포), metabolism(대사), excretion(배설)을 의미한다. 약물이 다양한 경로 (경구제 복용, 피하 주사, 정맥 주사, 근육 주사 등)를 통해 우리 몸에 들어오게 되면, 정맥주사 이외의 나머지는 흡수(absorption)의 과정을 거쳐 우리 몸의 정맥에 분포하게 되며, 이러한 약물은 분포(distribution)와 제거(metabolism) 과정에서 감소하게 되고, 제거 과정은 우리 몸에 투여된 물질이 여러 기관(organ)을 통해서 다른 물질로 변하여(metabolism) 제거되거나 물질이 변화하지 않고 그대로 배설(excretion) 되는 과정으로 진행되게 된다. 이러한 수치들은 각각 약물의 농도가 증가하고 감소하는 과정과 밀접하게 연관되어 있으며, 이러한 과정들을 정량화하여 식을 세울 수 있다면, 약물을 투여한 이후의 농도를 보다 정확하게 예측할 수 있다. 이 때 흡수와 관련된 지표로는 흡수속도 상수(absorption rate constant)와 생체이용률(bioavailability), 분포, 제거와 관련된 지표로는 분포용적(Volume of distribution)과 청소율(Clearance)을 이용하게 되며, 다음 값들을 정확하게 예측하는 것이 약동학 분야에서의 핵심 중의 하나라고 볼 수 있다. 이러한 지표들을 구하기 위해서 현재 여러가지 방법들을 사용하고 있으며, 그 중 가장 간단하고도 널리 쓰이는 방법은 비구획분석(Non-compartmental analysis, NCA)으로 FDA(Food and Drug Administration)에서도 다음의 방식으로 약동학적 지표를 구하는 것을 허용하고 있다. 따라서 이번 Edison system을 통하여 주어진 시간과 농도로부터 비구획 분석 방법을 사용하여 약동학적 주요 지표를 직접 구해보고자 한다. "],
["method.html", "Chapter 2 이론 및 계산 방법", " Chapter 2 이론 및 계산 방법 비구획 분석이란 시간, 농도가 표현되어 있는 곡선에서 아무런 가정을 하지 않고 분석하는 것을 의미한다. 이때 다음과 같은 가정을 통해서 최대농도(Cmax) 및 최대농도에 도달하는 시간(Tmax), 전체 시간-농도 곡선의 면적(Area under the time-concentration curve, AUC)등을 구하게 된다. 이를 통해 측정된 지표들을 통하여 약물의 특성을 파악하고 특정구간에서의 농도를 예측하게 된다. 비구획 분석에서는 기본적으로 statistical moment theory (단순히 하나의 분자가 우리 몸에 들어와서 제거되지 까지는 예측하는 것이 힘들지만 그 개개의 분자들의 양이 늘어날수록 그들의 전반적인 행동이 규칙적으로 이루어진다는 이론)를 가정하고 이를 통해 우리는 각각의 분자가 우리 몸에서 얼마나 머무는지에 대한 평균값을 예상할 수 있게 된다. 이 시간을 MRT(mean residence time)이라고 지칭하게 되며, 이것은 농도와 시간의 곱을 적분한 값에서 단순 농도 값을 적분한 농도를 나누어 준 값으로 다음과 같이 표현해 줄 수 있다. 이때 식에서 표현된 AUMC는 area under the first moment curve로 농도와 시간의 곱을 시간에 대해서 적분한 값에 해당하며 AUC는 area under concentration으로 농도를 시간에 대해 적분한 값에 해당한다. 하지만 이 때, 각각의 약물에서 농도와 시간 사이의 명확한 함수관계를 확인할 수 없고, 주어진 정보도 제한적이므로 농도를 시간으로 적분하기에는 상당한 어려움이 따른다. 따라서 이를 간소화 하기 위해 Linear trapezoidal method(농도-시간 곡선에서 농도를 측정한 점과 점 사이의 면적을 사다리꼴이라 가정하고 넓이를 구하는 방식)를 사용하게 된다. 처음 농도를 측정한 부분부터 마지막 샘플까지를 t1,t2 …tlast로 표현했을 시 t1과 t2의 사이의 AUC와 AUMC는 다음과 같이 계산된다. 이 방식을 계속 이용하여 각각의 구간 값의 합을 모두 더한 값으로 AUClast(처음 농도를 측정하기 시작한 구간부터 마지막 농도를 측정한 구간까지 linear trapezoidal method를 통해서 값을 계산한 방식), AUMClast(처음 농도를 측정하기 시작한 구간부터 마지막 농도를 측정한 구간까지 linear trapezoidal method를 통해서 값을 계산한 방식)를 측정해 주게 된다. Figure 1 Linear trapezoidal method 추가적으로 마지막으로 농도를 잰 시점에서 모든 약물이 우리 몸에서 빠져나가는 시점까지의 값을 구하기 위해서 마지막으로 측정한 점의 기울기가 그대로 약물이 모두 제거되는 시점까지 그대로 유지된다는 가정을 세우게 되며, 다음과 같이 Clast(가장 마지막으로 농도를 측정한 시점)에서 λ(Cmax 이후에 선형성이 가장 높은 3점을 선택하여 구한 기울기)를 구한 후 위와 같은 약동학 공식을 대입하여 값을 구해주게 된다. 약물이 우리 몸에 들어온 후 가장 높은 농도의 경우 실제 개개인에서 농도를 측정한 값들 중 가장 높은 농도를 실제 가장 높은 농도라 가정하여 사용하게 되고(이 지표를 Cmax라 지칭한다.), 이 시점을 Tmax라 부르게 된다. 위에서 구한 AUC와 Cmax, λ 를 가지고 나머지 주요 값을 계산하게 된다. 이 중 청소율(제거되는 속도)에 해당하는 clearance(일반적으로 CL이라 지칭한다.) 의 경우 다음의 약동학 기본 공식을 활용하여 구해주게 된다. (다음 수식에서 D는 dose로 투여량을, F는 생체이용률을 의미한다.) 우리 몸의 분포(disposition)을 알기 위해 우리 몸의 volume을 나타내는 volume of distribution at steady state(Vdss)는 위 공식을 이용하여 값을 추정하게 되고 추가적으로 우리 몸의 생체이용률을 측정하는 F의 경우(기본적으로 정맥주사시의 생체이용률을 1이라고 가정하게 된다.) 다음의 공식을 활용하여 값을 계산한다. (이중 Div는 정맥주사 투여량, Doral은 경구 투여량, AUCoral은 경구 투여에서의 AUC, AUCiv는 정맥투여에서의 AUC를 의미한다. 이처럼 AUC, Cmax, AUMC, λ 를 구하는 부분에 있어서는 non-compartmental analysis의 기본 가정들을 활용하였고 그 밖의 부분들에서는 현재 정형화된 공식들을 활용하여 적용하였다. 위 내용을 바탕으로 R을 기반으로 한 script를 구성한 후 전세계적으로 널리 쓰이고 있는 CDISC terminology를 각각의 지표들에 적용하여 결과값을 도출하였다. 또한 투여되는 방식을 3가지 분류(Extravascular, IV infusion, IV bolus)로 구분하여, 그에 맞는 각각의 식을 적용하였다. 마지막으로 시간당 농도의 변화율이 농도 증가 곡선보다 감소 곡선에서 완만하다는 점을 고려하여 농도가 감소하는 구간에서는 log값을 선택적으로 줄 수 있도록 설정하였으며, 흡수 속도 상수의 경우 현 NCA method를 통해 구하기에는 한계가 있어 따로 값을 제시하지 않았다. 흡수속도 상수를 구하기 위해서는 구획분석방법(compartmental analysis)이나 비선형 혼합모형(non-linear mixed effect modeling)을 사용하는 것이 바람직하다. Figure 2. Linear trapezoidal method를 적용한 AUC의 계산 Script Figure 3 약동학 지표들에 대해 각각의 공식을 적용한 Script의 예 "],
["noncompart-r-package.html", "Chapter 3 NonCompart R Package 3.1 이 장에서는 3.2 What is NonCompart R package? 3.3 How does it work?", " Chapter 3 NonCompart R Package 3.1 이 장에서는 We will see what NonCompart (Bae 2017) is and how it works. 3.2 What is NonCompart R package? Description: Conduct a noncompartmental analysis as closely as possible to the most widely used commercial software for pharmacokinetic analysis, i.e. ‘Phoenix(R) WinNonlin(R)’ https://www.certara.com/software/pkpd-modeling-and-simulation/phoenix-winnonlin/. (Gabrielsson 2016) Some features are CDISC SDTM terms Automatic slope selection with the same criterion of WinNonlin(R) Supporting both ‘linear-up linear-down’ and ‘linear-up log-down’ method Interval(partial) AUCs with ‘linear’ or ‘log’ interpolation method 3.3 How does it work? References "],
["how-to-use-noncompart.html", "Chapter 4 How to use NonCompart 4.1 Calculation Setting 4.2 Fitting, AUC, AUMC Result 4.3 Time Conc. Pred. Residual AUC AUMC Weight 4.4 Calculated Values", " Chapter 4 How to use NonCompart [출처] NonCompart 사용법|작성자 김민걸 선생님 자료를 옮겨와서 변형합니다. 아산병원 배균섭 교수님께서 만드신 NonCompart 패키지 사용법에 대해서 간략히 적어봅니다. 뭐 별로 복잡한 것은 아니지만, R 초심자들을 위해 설치단계부터… (참고로 첫칸의 &gt; 기호는 R에서 프롬프트 이므로 이는 타이핑하지 않는다.) 우선 R을 설치한다. R은 아래 링크에서 다운로드 받을 수 있다. https://cloud.r-project.org/ R을 실행한 후, 아래와 같이 패키지를 설치한다. install.packages(&quot;NonCompart&quot;) 이제 아래와 같이 입력하여 패키지를 불러오자. library(NonCompart) R에는 theophylline과 Indomethacin의 약동학 데이터가 내장되어 있다. Theoph: theophylline의 약동학 데이터, 12명, 320mg PO 단회투여, 0~24시간 채혈, NONMEM 의 run 폴더의 THEOPP 데이터와 동일 Indometh: Indomethacin의 약동학 데이터, 6명, 25mg IV bolus 단회투여, 0~8시간 채혈(0, 0.25, 0.5, 0.75, 1, 1.25, 2, 3, 4, 5, 6, 8 h) (데이터명의 첫글짜가 대문자임에 주의하길) 데이터를 살펴보자. head(Theoph) ## Subject Wt Dose Time conc ## 1 1 79.6 4.02 0.00 0.74 ## 2 1 79.6 4.02 0.25 2.84 ## 3 1 79.6 4.02 0.57 6.57 ## 4 1 79.6 4.02 1.12 10.50 ## 5 1 79.6 4.02 2.02 9.66 ## 6 1 79.6 4.02 3.82 8.58 데이터가 Subject, weight, Dose, Time, Concentration 으로 구성되었음을 알 수 있다. 이 패키지로 NCA 비구획방법으로 약동학 파라미터를 산출하기 위해서는 아래와 같이 하면 된다. 우선 Theophilline 의 약동학 파라미터를 구해보면, NonCompart::tabNCA(Theoph, &quot;Subject&quot;, &quot;Time&quot;, &quot;conc&quot;, dose=320) ## ID b0 CMAX CMAXD TMAX TLAG CLST CLSTP TLST ## [1,] 11 2.368785 10.50 0.03281250 1.12 0 3.28 3.2801465 24.37 ## [2,] 6 2.411237 8.33 0.02603125 1.92 0 0.90 0.8886398 24.30 ## [3,] 5 2.529712 8.20 0.02562500 1.02 0 1.05 1.0550967 24.17 ## [4,] 7 2.592755 8.60 0.02687500 1.07 0 1.15 1.1564216 24.65 ## [5,] 12 2.551092 11.40 0.03562500 1.00 0 1.57 1.5556951 24.35 ## [6,] 1 2.033404 6.44 0.02012500 1.15 0 0.92 0.9412712 23.85 ## [7,] 2 2.288550 7.09 0.02215625 3.48 0 1.15 1.1607192 24.22 ## [8,] 3 2.170403 7.56 0.02362500 2.02 0 1.25 1.2285268 24.12 ## [9,] 8 2.124648 9.03 0.02821875 0.63 0 1.12 1.1164831 24.43 ## [10,] 10 2.657705 10.21 0.03190625 3.55 0 2.42 2.4136923 23.70 ## [11,] 4 2.147594 8.00 0.02500000 0.98 0 0.86 0.8598066 24.08 ## [12,] 9 2.824493 9.75 0.03046875 3.52 0 1.17 1.1755390 24.15 ## LAMZHL LAMZ LAMZLL LAMZUL LAMZNPT CORRXY R2 ## [1,] 14.304378 0.04845700 9.05 24.37 3 -0.9999999 0.9999997 ## [2,] 6.659342 0.10408644 7.03 24.30 4 -0.9985967 0.9971954 ## [3,] 6.766087 0.10244431 9.00 24.17 3 -0.9996624 0.9993250 ## [4,] 6.981247 0.09928702 9.02 24.65 3 -0.9994619 0.9989241 ## [5,] 8.002264 0.08661888 7.02 24.35 4 -0.9993234 0.9986472 ## [6,] 7.894998 0.08779574 2.03 23.85 7 -0.9991203 0.9982413 ## [7,] 7.846668 0.08833650 6.98 24.22 4 -0.9993349 0.9986702 ## [8,] 8.510038 0.08145054 3.53 24.12 6 -0.9954961 0.9910124 ## [9,] 8.405999 0.08245863 8.80 24.43 3 -0.9997218 0.9994437 ## [10,] 9.246916 0.07495982 9.38 23.70 3 -0.9997543 0.9995087 ## [11,] 7.261237 0.09545856 9.03 24.08 3 -0.9999991 0.9999983 ## [12,] 6.286508 0.11025949 9.03 24.15 3 -0.9996984 0.9993968 ## R2ADJ AUCLST AUCALL AUCIFO AUCIFOD AUCIFP ## [1,] 0.9999995 148.92305 148.92305 216.61193 0.6769123 216.61496 ## [2,] 0.9957931 91.52680 91.52680 100.17346 0.3130421 100.06432 ## [3,] 0.9986499 99.28650 99.28650 109.53597 0.3422999 109.58572 ## [4,] 0.9978483 106.79630 106.79630 118.37888 0.3699340 118.44356 ## [5,] 0.9979708 121.29440 121.29440 139.41978 0.4356868 139.25463 ## [6,] 0.9978896 73.77555 73.77555 84.25442 0.2632951 84.49670 ## [7,] 0.9980053 90.75340 90.75340 103.77180 0.3242869 103.89315 ## [8,] 0.9887655 88.55995 88.55995 103.90669 0.3247084 103.64305 ## [9,] 0.9988873 86.32615 86.32615 99.90872 0.3122147 99.86607 ## [10,] 0.9990174 138.36810 138.36810 170.65206 0.5332877 170.56791 ## [11,] 0.9999965 80.09360 80.09360 89.10274 0.2784461 89.10072 ## [12,] 0.9987936 119.97750 119.97750 130.58883 0.4080901 130.63907 ## AUCIFPD AUCPEO AUCPEP AUMCLST AUMCIFO AUMCIFP AUMCPEO ## [1,] 0.6769217 31.248917 31.249876 1459.0711 4505.5348 4505.6709 67.61603 ## [2,] 0.3127010 8.631687 8.532030 706.5866 999.7723 996.0716 29.32525 ## [3,] 0.3424554 9.357173 9.398325 803.1859 1150.9648 1152.6529 30.21629 ## [4,] 0.3701361 9.784331 9.833594 901.0842 1303.2524 1305.4981 30.85881 ## [5,] 0.4351707 13.000579 12.897403 1017.1143 1667.7216 1661.7937 39.01174 ## [6,] 0.2640522 12.437174 12.688246 609.1524 978.4285 986.9665 37.74176 ## [7,] 0.3246661 12.545221 12.647366 782.4199 1245.0984 1249.4111 37.16000 ## [8,] 0.3238845 14.769730 14.552931 739.5346 1298.1158 1288.5201 43.03015 ## [9,] 0.3120815 13.594978 13.558076 705.2296 1201.7715 1200.2124 41.31750 ## [10,] 0.5330247 18.918002 18.878001 1278.1800 2473.9934 2470.8765 48.33535 ## [11,] 0.2784397 10.110962 10.108918 617.2422 928.5600 928.4900 33.52694 ## [12,] 0.4082471 8.125757 8.161087 977.8807 1330.3840 1332.0528 26.49636 ## AUMCPEP MRTEVLST MRTEVIFO MRTEVIFP VZFO VZFP CLFO ## [1,] 67.61701 9.797483 20.800031 20.800368 30486.75 30486.32 1477.296 ## [2,] 29.06267 7.719996 9.980411 9.954313 30690.44 30723.92 3194.459 ## [3,] 30.31850 8.089578 10.507642 10.518276 28517.10 28504.15 2921.415 ## [4,] 30.97775 8.437410 11.009163 11.022112 27225.96 27211.10 2703.185 ## [5,] 38.79419 8.385501 11.961873 11.933490 26497.99 26529.42 2295.227 ## [6,] 38.28034 8.256833 11.612785 11.680533 43259.73 43135.69 3798.020 ## [7,] 37.37691 8.621383 11.998427 12.025924 34908.44 34867.67 3083.689 ## [8,] 42.60589 8.350666 12.493092 12.432287 37810.51 37906.69 3079.686 ## [9,] 41.24126 8.169363 12.028695 12.018220 38842.79 38859.38 3202.924 ## [10,] 48.27018 9.237534 14.497296 14.486174 25015.54 25027.88 1875.160 ## [11,] 33.52193 7.706511 10.421227 10.420679 37622.19 37623.04 3591.360 ## [12,] 26.58844 8.150534 10.187579 10.196436 22224.29 22215.75 2450.439 ## CLFP ## [1,] 1477.276 ## [2,] 3197.943 ## [3,] 2920.088 ## [4,] 2701.709 ## [5,] 2297.949 ## [6,] 3787.130 ## [7,] 3080.088 ## [8,] 3087.520 ## [9,] 3204.292 ## [10,] 1876.086 ## [11,] 3591.441 ## [12,] 2449.497 ## attr(,&quot;units&quot;) ## [1] &quot;&quot; &quot;&quot; &quot;ug/L&quot; &quot;ug/L/mg&quot; &quot;h&quot; ## [6] &quot;h&quot; &quot;ug/L&quot; &quot;ug/L&quot; &quot;h&quot; &quot;h&quot; ## [11] &quot;/h&quot; &quot;h&quot; &quot;h&quot; &quot;&quot; &quot;&quot; ## [16] &quot;&quot; &quot;&quot; &quot;h*ug/L&quot; &quot;h*ug/L&quot; &quot;h*ug/L&quot; ## [21] &quot;h*ug/L/mg&quot; &quot;h*ug/L&quot; &quot;h*ug/L/mg&quot; &quot;%&quot; &quot;%&quot; ## [26] &quot;h2*ug/L&quot; &quot;h2*ug/L&quot; &quot;h2*ug/L&quot; &quot;%&quot; &quot;%&quot; ## [31] &quot;h&quot; &quot;h&quot; &quot;h&quot; &quot;L&quot; &quot;L&quot; ## [36] &quot;L/h&quot; &quot;L/h&quot; 다음으로 Indomethacin 의 약동학 파라미터를 구해보자. 이는 IV bolus 이므로 AdmMode 옵션이 추가된다. NonCompart::tabNCA(Indometh, &quot;Subject&quot;, &quot;time&quot;, &quot;conc&quot;, dose=25, adm=&quot;Bolus&quot;, dur=0.5, concUnit=&quot;mg/L&quot;) ## ID b0 CMAX CMAXD TMAX CLST CLSTP TLST LAMZHL ## [1,] 1 -1.72421060 1.50 0.0600 0.25 0.05 0.05024851 8 4.378127 ## [2,] 3 -0.17528686 2.03 0.0812 0.25 0.08 0.07475591 8 2.293063 ## [3,] 6 0.15557954 2.72 0.1088 0.25 0.08 0.03997258 8 1.642947 ## [4,] 2 0.20029695 1.85 0.0740 0.25 0.07 0.03196011 8 1.521910 ## [5,] 4 -0.98235713 2.05 0.0820 0.25 0.06 0.04957149 8 2.742446 ## [6,] 5 -0.04991898 2.31 0.0924 0.25 0.09 0.05624247 8 1.960699 ## LAMZ LAMZLL LAMZUL LAMZNPT CORRXY R2 R2ADJ ## [1,] 0.1583205 5.00 8 3 -0.9985323 0.9970667 0.9941335 ## [2,] 0.3022800 0.75 8 9 -0.9734830 0.9476691 0.9401933 ## [3,] 0.4218926 0.50 8 10 -0.9358558 0.8758261 0.8603043 ## [4,] 0.4554455 0.25 8 11 -0.9342510 0.8728249 0.8586943 ## [5,] 0.2527478 1.00 8 8 -0.9355449 0.8752442 0.8544516 ## [6,] 0.3535205 0.75 8 9 -0.9507649 0.9039538 0.8902329 ## C0 AUCLST AUCALL AUCIFO AUCIFOD AUCIFP AUCIFPD ## [1,] 2.393617 2.040452 2.040452 2.356267 0.09425069 2.357837 0.09431348 ## [2,] 2.528160 3.248520 3.248520 3.513175 0.14052701 3.495827 0.13983307 ## [3,] 4.965369 3.554421 3.554421 3.744043 0.14976171 3.649167 0.14596668 ## [4,] 2.462230 2.785279 2.785279 2.938974 0.11755898 2.855452 0.11421808 ## [5,] 4.040865 2.458858 2.458858 2.696249 0.10784996 2.654988 0.10619954 ## [6,] 3.705625 3.335703 3.335703 3.590285 0.14361141 3.494796 0.13979183 ## AUCPEO AUCPEP AUCPBEO AUCPBEP AUMCLST AUMCIFO AUMCIFP ## [1,] 13.403196 13.460844 20.65564 20.64189 3.271250 7.792554 7.815026 ## [2,] 7.533221 7.074344 16.21809 16.29857 6.398750 9.391522 9.195343 ## [3,] 5.064624 2.596369 25.65866 26.32577 5.006250 6.972678 5.988790 ## [4,] 5.229568 2.457520 18.34071 18.87718 4.381875 5.948903 5.097338 ## [5,] 8.804484 7.387236 28.23768 28.67652 3.707500 6.545866 6.052534 ## [6,] 7.090860 4.552269 20.94411 21.51637 5.532500 8.289291 7.255264 ## AUMCPEO AUMCPEP MRTIVLST MRTIVIFO MRTIVIFP VZO VZP ## [1,] 58.02083 58.14153 1.353199 3.057161 3.064490 67.01598 66.97136 ## [2,] 31.86674 30.41314 1.719743 2.423229 2.380377 23.54132 23.65814 ## [3,] 28.20191 16.40632 1.158457 1.612339 1.391139 15.82695 16.23844 ## [4,] 26.34146 14.03601 1.323227 1.774142 1.535125 18.67703 19.22334 ## [5,] 43.36120 38.74467 1.257814 2.177768 2.029684 36.68535 37.25547 ## [6,] 33.25726 23.74502 1.408571 2.058811 1.826019 19.69683 20.23502 ## CLO CLP VSSO VSSP ## [1,] 10.610002 10.602939 32.43648 32.492596 ## [2,] 7.116070 7.151384 17.24387 17.022991 ## [3,] 6.677274 6.850879 10.76603 9.530524 ## [4,] 8.506369 8.755181 15.09151 13.440293 ## [5,] 9.272141 9.416237 20.19257 19.111984 ## [6,] 6.963235 7.153494 14.33599 13.062419 ## attr(,&quot;units&quot;) ## [1] &quot;&quot; &quot;&quot; &quot;mg/L&quot; &quot;mg/L/mg&quot; &quot;h&quot; ## [6] &quot;mg/L&quot; &quot;mg/L&quot; &quot;h&quot; &quot;h&quot; &quot;/h&quot; ## [11] &quot;h&quot; &quot;h&quot; &quot;&quot; &quot;&quot; &quot;&quot; ## [16] &quot;&quot; &quot;mg/L&quot; &quot;h*mg/L&quot; &quot;h*mg/L&quot; &quot;h*mg/L&quot; ## [21] &quot;h*mg/L/mg&quot; &quot;h*mg/L&quot; &quot;h*mg/L/mg&quot; &quot;%&quot; &quot;%&quot; ## [26] &quot;%&quot; &quot;%&quot; &quot;h2*mg/L&quot; &quot;h2*mg/L&quot; &quot;h2*mg/L&quot; ## [31] &quot;%&quot; &quot;%&quot; &quot;h&quot; &quot;h&quot; &quot;h&quot; ## [36] &quot;L&quot; &quot;L&quot; &quot;L/h&quot; &quot;L/h&quot; &quot;L&quot; ## [41] &quot;L&quot; NCA의 사용법은 다음과 같다. NCA(Data, colSubj, colTime, colConc, colTrt, Method = “Linear”, Dose = 0, AdmMode = “Extravascular”, TimeInfusion = 0, Report = “Table”, iAUC) Data는 데이터셋을 설정하며. colSubj는 subject ID의 컬럼명, colTime은 time의 컬럼명, colConc는 concentration의 컬럼명, colTrT는 treatment code의 컬럼명(교차시험에서 사용)이다. tabNCA(concData, colSubj = &quot;Subject&quot;, colTime = &quot;Time&quot;, colConc = &quot;conc&quot;, dose = 0, adm = &quot;Extravascular&quot;, dur = 0, doseUnit = &quot;mg&quot;, timeUnit = &quot;h&quot;, concUnit = &quot;ug/L&quot;, down = &quot;Linear&quot;, MW = 0, returnNA = FALSE) NCA의 옵션들에 대해서 간단히 살펴보자면 다음과 같다. Method AUC와 AUMC를 구하는 trapezoidal method 설정, 기본값은 Method=“Linear” Linear와 Log 중 선택 가능하다. Linear는 Linear trapezoidal method이며, Log는 Linear-up and log-down method 이다. Dose 투여량에 대한 설정이다. 단위에 주의해야 한다. 벡터값을 줌으로서 각 대상자별 용량을 다르게 할 수 있다. AdmMode 투여경로에 대한 설정, 기본값은 AdmMode= “Extravascular” Bolus, Infusion, Extravascular 중에서 선택 가능하다. TimeInfusion 주입하는 기간(infusion duration)을 설정한다. 기본값은 0이다. Report 출력물의 형태. 기본값은 Report=“Table” 이다. Table, Text 증에서 선택 가능하다. iAUC 일부구간에 대한 AUC를 구하기 위한 구간설정 옵션이다. “Name”, “Start”, “End” 3개의 컬럼으로 구성된 데이터 프레임으로 설정해야 한다. 일부 구간의 AUC를 구하는 방법은 조금 더 복잡하므로 자세히 알아보자. 예를 들어 0~12시간까지의 AUC, 0~24시간까지의 AUC를 구하고자 한다면 다음과 같이 하면 된다. 먼저 구하고자 하는 구간에 대한 정보를 갖는 변수를 아래와같이 생성한다. iAUC = data.frame(Name=c(&quot;AUC[0-12h]&quot;,&quot;AUC[0-24h]&quot;), Start=c(0,0), End=c(12,24)) ; iAUC ## Name Start End ## 1 AUC[0-12h] 0 12 ## 2 AUC[0-24h] 0 24 Name Start End 1 AUC[0-12h] 0 12 2 AUC[0-24h] 0 24 이제 iAUC 옵션을 이용해서 이를 구한다. # tabNCA(Theoph, &quot;Subject&quot;, &quot;Time&quot;, &quot;conc&quot;, dose=320, iAUC=iAUC) Subject CMAX CMAXD TMAX TLAG CLST CLSTP TLST LAMZHL LAMZ LAMZLL LAMZUL LAMZNPT CORRXY R2 R2ADJ 1 1 10.50 0.03281250 1.12 0 3.28 3.2801465 24.37 14.304378 0.04845700 9.05 24.37 3 -0.9999999 0.9999997 0.9999995 2 2 8.33 0.02603125 1.92 0 0.90 0.8886398 24.30 6.659342 0.10408644 7.03 24.30 4 -0.9985967 0.9971954 0.9957931 3 3 8.20 0.02562500 1.02 0 1.05 1.0550967 24.17 6.766087 0.10244431 9.00 24.17 3 -0.9996624 0.9993250 0.9986499 4 4 8.60 0.02687500 1.07 0 1.15 1.1564216 24.65 6.981247 0.09928702 9.02 24.65 3 -0.9994619 0.9989241 0.9978483 5 5 11.40 0.03562500 1.00 0 1.57 1.5556951 24.35 8.002264 0.08661888 7.02 24.35 4 -0.9993234 0.9986472 0.9979708 6 6 6.44 0.02012500 1.15 0 0.92 0.9412712 23.85 7.894998 0.08779574 2.03 23.85 7 -0.9991203 0.9982413 0.9978896 7 7 7.09 0.02215625 3.48 0 1.15 1.1607192 24.22 7.846668 0.08833650 6.98 24.22 4 -0.9993349 0.9986702 0.9980053 8 8 7.56 0.02362500 2.02 0 1.25 1.2285268 24.12 8.510038 0.08145054 3.53 24.12 6 -0.9954961 0.9910124 0.9887655 9 9 9.03 0.02821875 0.63 0 1.12 1.1164831 24.43 8.405999 0.08245863 8.80 24.43 3 -0.9997218 0.9994437 0.9988873 10 10 10.21 0.03190625 3.55 0 2.42 2.4136923 23.70 9.246916 0.07495982 9.38 23.70 3 -0.9997543 0.9995087 0.9990174 11 11 8.00 0.02500000 0.98 0 0.86 0.8598066 24.08 7.261237 0.09545856 9.03 24.08 3 -0.9999991 0.9999983 0.9999965 12 12 9.75 0.03046875 3.52 0 1.17 1.1755390 24.15 6.286508 0.11025949 9.03 24.15 3 -0.9996984 0.9993968 0.9987936 AUCLST AUCALL AUCIFO AUCIFOD AUCPEO AUCIFP AUCIFPD AUCPEP AUMCLST AUMCIFO AUMCPEO AUMCIFP AUMCPEP 1 148.92305 148.92305 216.61193 0.6769123 31.248917 216.61496 0.6769217 31.249876 1459.0711 4505.5348 67.61603 4505.6709 67.61701 2 91.52680 91.52680 100.17346 0.3130421 8.631687 100.06432 0.3127010 8.532030 706.5866 999.7723 29.32525 996.0716 29.06267 3 99.28650 99.28650 109.53597 0.3422999 9.357173 109.58572 0.3424554 9.398325 803.1859 1150.9648 30.21629 1152.6529 30.31850 4 106.79630 106.79630 118.37888 0.3699340 9.784331 118.44356 0.3701361 9.833594 901.0842 1303.2524 30.85881 1305.4981 30.97775 5 121.29440 121.29440 139.41978 0.4356868 13.000579 139.25463 0.4351707 12.897403 1017.1143 1667.7216 39.01174 1661.7937 38.79419 6 73.77555 73.77555 84.25442 0.2632951 12.437174 84.49670 0.2640522 12.688246 609.1524 978.4285 37.74176 986.9665 38.28034 7 90.75340 90.75340 103.77180 0.3242869 12.545221 103.89315 0.3246661 12.647366 782.4199 1245.0984 37.16000 1249.4111 37.37691 8 88.55995 88.55995 103.90669 0.3247084 14.769730 103.64305 0.3238845 14.552931 739.5346 1298.1158 43.03015 1288.5201 42.60589 9 86.32615 86.32615 99.90872 0.3122147 13.594978 99.86607 0.3120815 13.558076 705.2296 1201.7715 41.31750 1200.2124 41.24126 10 138.36810 138.36810 170.65206 0.5332877 18.918002 170.56791 0.5330247 18.878001 1278.1800 2473.9934 48.33535 2470.8765 48.27018 11 80.09360 80.09360 89.10274 0.2784461 10.110962 89.10072 0.2784397 10.108918 617.2422 928.5600 33.52694 928.4900 33.52193 12 119.97750 119.97750 130.58883 0.4080901 8.125757 130.63907 0.4082471 8.161087 977.8807 1330.3840 26.49636 1332.0528 26.58844 MRTEVLST MRTEVIFO MRTEVIFP VZFO VZFP CLFO CLFP AUC[0-12h] AUC[0-24h] 1 9.797483 20.800031 20.800368 30.48675 30.48632 1.477296 1.477276 91.73552 147.69459 2 7.719996 9.980411 9.954313 30.69044 30.72392 3.194459 3.197943 67.48030 91.24908 3 8.089578 10.507642 10.518276 28.51710 28.50415 2.921415 2.920088 70.17971 99.10481 4 8.437410 11.009163 11.022112 27.22596 27.21110 2.703185 2.701709 73.05115 105.99811 5 8.385501 11.961873 11.933490 26.49799 26.52942 2.295227 2.297949 84.61490 120.73101 6 8.256833 11.612785 11.680533 43.25973 43.13569 3.798020 3.787130 51.75887 73.91422 7 8.621383 11.998427 12.025924 34.90844 34.86767 3.083689 3.080088 62.09875 90.49567 8 8.350666 12.493092 12.432287 37.81051 37.90669 3.079686 3.087520 62.71486 88.40890 9 8.169363 12.028695 12.018220 38.84279 38.85938 3.202924 3.204292 60.12123 85.82985 10 9.237534 14.497296 14.486174 25.01554 25.02788 1.875160 1.876086 90.81742 139.08507 11 7.706511 10.421227 10.420679 37.62219 37.62304 3.591360 3.591441 58.53963 80.02431 12 8.150534 10.187579 10.196436 22.22429 22.21575 2.450439 2.449497 85.02136 119.79884 맨 마지막 파라미터로 AUC[0-12h], AUC[0-24h]가 추가되었음을 알 수 있다. 약동학 파라이터를 보고서 형식의 text 파일로 저장해보자. 우선 저장될 폴더를 확인해면, getwd() ## [1] &quot;C:/Users/mdlhs/asancpt/NonCompartbook&quot; 저장될 폴더를 변경하고자 한다면 setwd(“저장될 경로”) 이렇게 설정하면 된다. 위에서 사용한 NCA 명령어에 Report=“Text” 라는 옵션을 추가하면 된다. 먼저, Theophilline 자료의 약동학 파라미터 분석 결과는 아래와 같이 텍스트파일로 저장할 수 있다. #writeLines(NCA(Theoph, &quot;Subject&quot;, &quot;Time&quot;, &quot;conc&quot;, Dose=320, Report=&quot;Text&quot;), &quot;Theoph_Linear_CoreOutput.txt&quot;) 저장된 파일 내용은 아래와 같다. NCA REPORT Subject=1 NONCOMPARTMENTAL ANALYSIS REPORT Package version 0.2.6 (2017-01-01) R version 3.3.3 (2017-03-06) Date and Time: 2017-03-11 20:46:33 KST 4.1 Calculation Setting Drug Administration: Extravascular Observation count excluding trailing zero: 11 Dose at time 0: 320 AUC Calculation method: Linear-up Linear-down method Weighting for lambda z: Uniform (Ordinary Least Square, OLS) Lambda z selection criterion: Heighest adjusted R-squared value with precision=1e-4 4.2 Fitting, AUC, AUMC Result 4.3 Time Conc. Pred. Residual AUC AUMC Weight 0.0000 0.7400 0.0000 0.0000 0.2500 2.8400 0.4475 0.0888 0.5700 6.5700 1.9531 0.8015 1.1200 10.5000 6.6474 5.0654 2.0200 9.6600 15.7194 19.1383 3.8200 8.5800 32.1354 66.1982 5.1000 8.3600 42.9769 114.4617 7.0300 7.4700 58.2529 206.2815 9.0500 * 6.8900 6.8912 -1.228e-03 72.7565 322.2988 1.0000 12.1200 * 5.9400 5.9387 +1.324e-03 92.4505 528.5219 1.0000 24.3700 * 3.2800 3.2801 -1.465e-04 148.9231 1459.0711 1.0000 *: Used for the calculation of Lambda z. 4.4 Calculated Values CMAX Max Conc 10.5000 CMAXD Max Conc Norm by Dose 0.0328 TMAX Time of CMAX 1.1200 TLAG Time Until First Nonzero Conc 0.0000 CLST Last Nonzero Conc 3.2800 … 개인별 약동학 파라미터를 구하려면 아래와 같이 할 수 있다. IndiNCA를 사용하면 되며, NCA와의 차이점은 데이터셋과 subject 설정이 빠진다는 점이다. IndiNCA(Theoph[Theoph$Subject==1,“Time”], Theoph[Theoph$Subject==1, “conc”], Dose=320) CMAX CMAXD TMAX TLAG CLST CLSTP TLST LAMZHL LAMZ 10.5000000 0.0328125 1.1200000 0.0000000 3.2800000 3.2801465 24.3700000 14.3043776 0.0484570 LAMZLL LAMZUL LAMZNPT CORRXY R2 R2ADJ AUCLST AUCALL AUCIFO 9.0500000 24.3700000 3.0000000 -0.9999999 0.9999997 0.9999995 148.9230500 148.9230500 216.6119330 AUCIFOD AUCPEO AUCIFP AUCIFPD AUCPEP AUMCLST AUMCIFO AUMCPEO AUMCIFP 0.6769123 31.2489169 216.6149558 0.6769217 31.2498763 1459.0711035 4505.5348194 67.6160287 4505.6708646 AUMCPEP MRTEVLST MRTEVIFO MRTEVIFP VZFO VZFP CLFO CLFP 67.6170065 9.7974834 20.8000305 20.8003683 30.4867482 30.4863228 1.4772963 1.4772757 개인별 약동학 파라미터를 보고서 형식의 text 파일로 저장해보자. Report 옵션을 추가하면 된다. Report=“Text” 를 추가해보자. IndiNCA(Theoph[Theoph$Subject==1,“Time”], Theoph[Theoph$Subject==1, “conc”], Dose=320, Report=“Text”) [1] &quot; NONCOMPARTMENTAL ANALYSIS REPORT&quot; [2] &quot; Package version 0.2.6 (2017-01-01)&quot; [3] &quot; R version 3.3.3 (2017-03-06)&quot; [4] “” [5] “Date and Time: 2017-03-11 21:12:40 KST” [6] “” [7] “Calculation Setting” [8] “——————-” [9] “Drug Administration: Extravascular” [10] “Observation count excluding trailing zero: 11” [11] “Dose at time 0: 320” [12] “AUC Calculation method: Linear-up Linear-down method” [13] “Weighting for lambda z: Uniform (Ordinary Least Square, OLS)” [14] “Lambda z selection criterion: Heighest adjusted R-squared value with precision=1e-4” [15] “” [16] “” [17] “Fitting, AUC, AUMC Result” [18] “————————-” [19] &quot; Time Conc. Pred. Residual AUC AUMC Weight&quot; [20] “——————————————————————————-” [21] &quot; 0.0000 0.7400 0.0000 0.0000 &quot; [22] &quot; 0.2500 2.8400 0.4475 0.0888 &quot; [23] &quot; 0.5700 6.5700 1.9531 0.8015 &quot; [24] &quot; 1.1200 10.5000 6.6474 5.0654 &quot; [25] &quot; 2.0200 9.6600 15.7194 19.1383 &quot; [26] &quot; 3.8200 8.5800 32.1354 66.1982 &quot; [27] &quot; 5.1000 8.3600 42.9769 114.4617 &quot; [28] &quot; 7.0300 7.4700 58.2529 206.2815 &quot; [29] &quot; 9.0500 * 6.8900 6.8912 -1.228e-03 72.7565 322.2988 1.0000&quot; [30] &quot; 12.1200 * 5.9400 5.9387 +1.324e-03 92.4505 528.5219 1.0000&quot; [31] &quot; 24.3700 * 3.2800 3.2801 -1.465e-04 148.9231 1459.0711 1.0000&quot; [32] “” [33] “*: Used for the calculation of Lambda z.&quot; [34] “” [35] “” [36] “Calculated Values” [37] “—————–” [38] “CMAX Max Conc 10.5000” [39] “CMAXD Max Conc Norm by Dose 0.0328” [40] “TMAX Time of CMAX 1.1200” [41] “TLAG Time Until First Nonzero Conc 0.0000” [42] “CLST Last Nonzero Conc 3.2800” [43] “CLSTP Last Nonzero Conc Pred 3.2801” [44] “TLST Time of Last Nonzero Conc 24.3700” [45] “LAMZHL Half-Life Lambda z 14.3044” [46] “LAMZ Lambda z 0.0485” [47] “LAMZLL Lambda z Lower Limit 9.0500” [48] “LAMZUL Lambda z Upper Limit 24.3700” [49] “LAMZNPT Number of Points for Lambda z 3” [50] “CORRXY Correlation Between TimeX and Log ConcY -1.0000” [51] “R2 R Squared 1.0000” [52] “R2ADJ R Squared Adjusted 1.0000” [53] “AUCLST AUC to Last Nonzero Conc 148.9231” [54] “AUCALL AUC All 148.9231” [55] “AUCIFO AUC Infinity Obs 216.6119” [56] “AUCIFOD AUC Infinity Obs Norm by Dose 0.6769” [57] “AUCPEO AUC %Extrapolation Obs 31.2489” [58] “AUCIFP AUC Infinity Pred 216.6150” [59] “AUCIFPD AUC Infinity Pred Norm by Dose 0.6769” [60] “AUCPEP AUC %Extrapolation Pred 31.2499” [61] “AUMCLST AUMC to Last Nonzero Conc 1459.0711” [62] “AUMCIFO AUMC Infinity Obs 4505.5348” [63] “AUMCPEO AUMC %Extrapolation Obs 67.6160” [64] “AUMCIFP AUMC Infinity Pred 4505.6709” [65] “AUMCPEP AUMC % Extrapolation Pred 67.6170” [66] “MRTEVLST MRT Extravasc to Last Nonzero Conc 9.7975” [67] “MRTEVIFO MRT Extravasc Infinity Obs 20.8000” [68] “MRTEVIFP MRT Extravasc Infinity Pred 20.8004” [69] “VZFO Vz Obs by F 30.4867” [70] “VZFP Vz Pred by F 30.4863” [71] “CLFO Total CL Obs by F 1.4773” [72] “CLFP Total CL Pred by F 1.4773” 개인별 일부 구간의 AUC를 구하는 방법은 아래와 같다. 예를 들어 0~12시간까지의 AUC, 0~24시간까지의 AUC를 구하고자 한다면 다음과 같이 하면 된다. iAUC = data.frame(Name=c(“AUC[0-12h]”,“AUC[0-24h]”), Start=c(0,0), End=c(12,24)) ; iAUC Name Start End 1 AUC[0-12h] 0 12 2 AUC[0-24h] 0 24 IntAUC ## function (x, y, t1, t2, Res, down = &quot;Linear&quot;) ## { ## n = length(x) ## if (n != length(y) | !is.numeric(x) | !is.numeric(y)) ## stop(&quot;Bad Input!&quot;) ## if (t1 &gt; Res[&quot;TLST&quot;]) ## stop(&quot;Start time of interval AUC is after Tlast.&quot;) ## tL = Res[&quot;TLST&quot;] ## if (t2 &gt; tL &amp; is.na(Res[&quot;LAMZ&quot;])) ## return(NA) ## newSeries = Interpol(x, y, t1, Res[&quot;LAMZ&quot;], Res[&quot;b0&quot;], down = down) ## newSeries = Interpol(newSeries[[1]], newSeries[[2]], t2, ## Res[&quot;LAMZ&quot;], Res[&quot;b0&quot;], down = down) ## x = newSeries[[1]] ## y = newSeries[[2]] ## if (down == &quot;Linear&quot;) { ## if (t2 &lt;= tL) { ## ResIntAUC = LinAUC(x[x &gt;= t1 &amp; x &lt;= t2], y[x &gt;= t1 &amp; ## x &lt;= t2])[[1]] ## } ## else { ## ResIntAUC = LinAUC(x[x &gt;= t1 &amp; x &lt;= tL], y[x &gt;= t1 &amp; ## x &lt;= tL])[[1]] + LogAUC(x[x &gt;= tL &amp; x &lt;= t2], ## y[x &gt;= tL &amp; x &lt;= t2])[[1]] ## } ## } ## else if (down == &quot;Log&quot;) { ## ResIntAUC = LogAUC(x[x &gt;= t1 &amp; x &lt;= t2], y[x &gt;= t1 &amp; ## x &lt;= t2])[[1]] ## } ## else stop(&quot;Unknown down method!&quot;) ## return(ResIntAUC) ## } ## &lt;environment: namespace:NonCompart&gt; IntAUC(Theoph[Theoph$Subject==1,&quot;Time&quot;], Theoph[Theoph$Subject==1, &quot;conc&quot;], Dose=320, iAUC=iAUC) ## Error in IntAUC(Theoph[Theoph$Subject == 1, &quot;Time&quot;], Theoph[Theoph$Subject == : 사용되지 않은 인자 (Dose = 320, iAUC = iAUC) CMAX CMAXD TMAX TLAG CLST CLSTP TLST LAMZHL LAMZ 10.5000000 0.0328125 1.1200000 0.0000000 3.2800000 3.2801465 24.3700000 14.3043776 0.0484570 LAMZLL LAMZUL LAMZNPT CORRXY R2 R2ADJ AUCLST AUCALL AUCIFO 9.0500000 24.3700000 3.0000000 -0.9999999 0.9999997 0.9999995 148.9230500 148.9230500 216.6119330 AUCIFOD AUCPEO AUCIFP AUCIFPD AUCPEP AUMCLST AUMCIFO AUMCPEO AUMCIFP 0.6769123 31.2489169 216.6149558 0.6769217 31.2498763 1459.0711035 4505.5348194 67.6160287 4505.6708646 AUMCPEP MRTEVLST MRTEVIFO MRTEVIFP VZFO VZFP CLFO CLFP AUC[0-12h] 67.6170065 9.7974834 20.8000305 20.8003683 30.4867482 30.4863228 1.4772963 1.4772757 91.7355220 AUC[0-24h] 147.6945866 전반적으로 초보자도 어렵지 않게 사용할 수 있다. 역시 배균섭 교수님 이시다. 약동학 Plot 도 자동으로 그려주면 더 좋을텐데..ㅎㅎ "],
["DetailsNCA.html", "Chapter 5 NCA 소프트웨어 5.1 이 장에서는 5.2 Certara Phoenix WinNonLin 5.3 R package: pkr 5.4 R package: PKNCA 5.5 R package: ncappc 5.6 R package: PK 5.7 Kinetica 5.8 Scientist 5.9 PKSolver 5.10 Summary", " Chapter 5 NCA 소프트웨어 5.1 이 장에서는 이 장에서는 몇가지 NCA 용 소프트웨어(상용 소프웨어, R 패키지)를 비교하고 분석하여 그 결과와 사용법의 공통점과 차이점을 알아볼 것입니다. 특별히 Theoph 데이타셋에서 Cmax, AUCinf가 동일하게 나오는지 초점을 맞추어 실펴보겠습니다. 5.2 Certara Phoenix WinNonLin https://www.certara.com/software/pkpd-modeling-and-simulation/phoenix-winnonlin/ 5.2.1 Pros Validated for several years Industry standard Versatile unit setting Easy using by GUI Generating plots supported 5.2.2 Cons Expansive (~several thousand dollars) Not suitable for reproducible research CDISC SDTM not compatible (input and output) 5.3 R package: pkr Extension of NonCompart for CDISC input 5.3.1 Pros Open source and free of charge CDISC SDTM fully compatible (input - DM, EX, PC) Output of CDISC SDTM PP domain terms Calculate partial(interval) AUC with ‘linear’ or ‘log’ interpolation method 5.3.2 Cons More tests required Experience with R language required Generating plots not supported for now (To be supported soon) # Theoph and Indometh data: dose in mg, conc in mg/L, time in h pkr::NCA(Theoph, &quot;Subject&quot;, &quot;Time&quot;, &quot;conc&quot;, dose=320, uConc=&quot;mg/L&quot;) ## Subject CMAX CMAXD TMAX TLAG CLST CLSTP TLST LAMZHL ## 1 1 10.50 0.03281250 1.12 0 3.28 3.2801465 24.37 14.304378 ## 2 2 8.33 0.02603125 1.92 0 0.90 0.8886398 24.30 6.659342 ## 3 3 8.20 0.02562500 1.02 0 1.05 1.0550967 24.17 6.766087 ## 4 4 8.60 0.02687500 1.07 0 1.15 1.1564216 24.65 6.981247 ## 5 5 11.40 0.03562500 1.00 0 1.57 1.5556951 24.35 8.002264 ## 6 6 6.44 0.02012500 1.15 0 0.92 0.9412712 23.85 7.894998 ## 7 7 7.09 0.02215625 3.48 0 1.15 1.1607192 24.22 7.846668 ## 8 8 7.56 0.02362500 2.02 0 1.25 1.2285268 24.12 8.510038 ## 9 9 9.03 0.02821875 0.63 0 1.12 1.1164831 24.43 8.405999 ## 10 10 10.21 0.03190625 3.55 0 2.42 2.4136923 23.70 9.246916 ## 11 11 8.00 0.02500000 0.98 0 0.86 0.8598066 24.08 7.261237 ## 12 12 9.75 0.03046875 3.52 0 1.17 1.1755390 24.15 6.286508 ## LAMZ LAMZLL LAMZUL LAMZNPT CORRXY R2 R2ADJ ## 1 0.04845700 9.05 24.37 3 -0.9999999 0.9999997 0.9999995 ## 2 0.10408644 7.03 24.30 4 -0.9985967 0.9971954 0.9957931 ## 3 0.10244431 9.00 24.17 3 -0.9996624 0.9993250 0.9986499 ## 4 0.09928702 9.02 24.65 3 -0.9994619 0.9989241 0.9978483 ## 5 0.08661888 7.02 24.35 4 -0.9993234 0.9986472 0.9979708 ## 6 0.08779574 2.03 23.85 7 -0.9991203 0.9982413 0.9978896 ## 7 0.08833650 6.98 24.22 4 -0.9993349 0.9986702 0.9980053 ## 8 0.08145054 3.53 24.12 6 -0.9954961 0.9910124 0.9887655 ## 9 0.08245863 8.80 24.43 3 -0.9997218 0.9994437 0.9988873 ## 10 0.07495982 9.38 23.70 3 -0.9997543 0.9995087 0.9990174 ## 11 0.09545856 9.03 24.08 3 -0.9999991 0.9999983 0.9999965 ## 12 0.11025949 9.03 24.15 3 -0.9996984 0.9993968 0.9987936 ## AUCLST AUCALL AUCIFO AUCIFOD AUCPEO AUCIFP AUCIFPD ## 1 148.92305 148.92305 216.61193 0.6769123 31.248917 216.61496 0.6769217 ## 2 91.52680 91.52680 100.17346 0.3130421 8.631687 100.06432 0.3127010 ## 3 99.28650 99.28650 109.53597 0.3422999 9.357173 109.58572 0.3424554 ## 4 106.79630 106.79630 118.37888 0.3699340 9.784331 118.44356 0.3701361 ## 5 121.29440 121.29440 139.41978 0.4356868 13.000579 139.25463 0.4351707 ## 6 73.77555 73.77555 84.25442 0.2632951 12.437174 84.49670 0.2640522 ## 7 90.75340 90.75340 103.77180 0.3242869 12.545221 103.89315 0.3246661 ## 8 88.55995 88.55995 103.90669 0.3247084 14.769730 103.64305 0.3238845 ## 9 86.32615 86.32615 99.90872 0.3122147 13.594978 99.86607 0.3120815 ## 10 138.36810 138.36810 170.65206 0.5332877 18.918002 170.56791 0.5330247 ## 11 80.09360 80.09360 89.10274 0.2784461 10.110962 89.10072 0.2784397 ## 12 119.97750 119.97750 130.58883 0.4080901 8.125757 130.63907 0.4082471 ## AUCPEP AUMCLST AUMCIFO AUMCPEO AUMCIFP AUMCPEP MRTEVLST ## 1 31.249876 1459.0711 4505.5348 67.61603 4505.6709 67.61701 9.797483 ## 2 8.532030 706.5866 999.7723 29.32525 996.0716 29.06267 7.719996 ## 3 9.398325 803.1859 1150.9648 30.21629 1152.6529 30.31850 8.089578 ## 4 9.833594 901.0842 1303.2524 30.85881 1305.4981 30.97775 8.437410 ## 5 12.897403 1017.1143 1667.7216 39.01174 1661.7937 38.79419 8.385501 ## 6 12.688246 609.1524 978.4285 37.74176 986.9665 38.28034 8.256833 ## 7 12.647366 782.4199 1245.0984 37.16000 1249.4111 37.37691 8.621383 ## 8 14.552931 739.5346 1298.1158 43.03015 1288.5201 42.60589 8.350666 ## 9 13.558076 705.2296 1201.7715 41.31750 1200.2124 41.24126 8.169363 ## 10 18.878001 1278.1800 2473.9934 48.33535 2470.8765 48.27018 9.237534 ## 11 10.108918 617.2422 928.5600 33.52694 928.4900 33.52193 7.706511 ## 12 8.161087 977.8807 1330.3840 26.49636 1332.0528 26.58844 8.150534 ## MRTEVIFO MRTEVIFP VZFO VZFP CLFO CLFP ## 1 20.800031 20.800368 30.48675 30.48632 1.477296 1.477276 ## 2 9.980411 9.954313 30.69044 30.72392 3.194459 3.197943 ## 3 10.507642 10.518276 28.51710 28.50415 2.921415 2.920088 ## 4 11.009163 11.022112 27.22596 27.21110 2.703185 2.701709 ## 5 11.961873 11.933490 26.49799 26.52942 2.295227 2.297949 ## 6 11.612785 11.680533 43.25973 43.13569 3.798020 3.787130 ## 7 11.998427 12.025924 34.90844 34.86767 3.083689 3.080088 ## 8 12.493092 12.432287 37.81051 37.90669 3.079686 3.087520 ## 9 12.028695 12.018220 38.84279 38.85938 3.202924 3.204292 ## 10 14.497296 14.486174 25.01554 25.02788 1.875160 1.876086 ## 11 10.421227 10.420679 37.62219 37.62304 3.591360 3.591441 ## 12 10.187579 10.196436 22.22429 22.21575 2.450439 2.449497 pkr::NCA(Indometh, &quot;Subject&quot;, &quot;time&quot;, &quot;conc&quot;, dose=25, adm=&quot;Bolus&quot;, uConc=&quot;mg/L&quot;) ## Subject CMAX CMAXD TMAX C0 AUCPBEO AUCPBEP CLST CLSTP TLST ## 1 1 1.50 0.0600 0.25 2.393617 20.65564 20.64189 0.05 0.05024851 8 ## 2 2 2.03 0.0812 0.25 2.528160 16.21809 16.29857 0.08 0.07475591 8 ## 3 3 2.72 0.1088 0.25 4.965369 25.65866 26.32577 0.08 0.03997258 8 ## 4 4 1.85 0.0740 0.25 2.462230 18.34071 18.87718 0.07 0.03196011 8 ## 5 5 2.05 0.0820 0.25 4.040865 28.23768 28.67652 0.06 0.04957149 8 ## 6 6 2.31 0.0924 0.25 3.705625 20.94411 21.51637 0.09 0.05624247 8 ## LAMZHL LAMZ LAMZLL LAMZUL LAMZNPT CORRXY R2 R2ADJ ## 1 4.378127 0.1583205 5.00 8 3 -0.9985323 0.9970667 0.9941335 ## 2 2.293063 0.3022800 0.75 8 9 -0.9734830 0.9476691 0.9401933 ## 3 1.642947 0.4218926 0.50 8 10 -0.9358558 0.8758261 0.8603043 ## 4 1.521910 0.4554455 0.25 8 11 -0.9342510 0.8728249 0.8586943 ## 5 2.742446 0.2527478 1.00 8 8 -0.9355449 0.8752442 0.8544516 ## 6 1.960699 0.3535205 0.75 8 9 -0.9507649 0.9039538 0.8902329 ## AUCLST AUCALL AUCIFO AUCIFOD AUCPEO AUCIFP AUCIFPD ## 1 2.040452 2.040452 2.356267 0.09425069 13.403196 2.357837 0.09431348 ## 2 3.248520 3.248520 3.513175 0.14052701 7.533221 3.495827 0.13983307 ## 3 3.554421 3.554421 3.744043 0.14976171 5.064624 3.649167 0.14596668 ## 4 2.785279 2.785279 2.938974 0.11755898 5.229568 2.855452 0.11421808 ## 5 2.458858 2.458858 2.696249 0.10784996 8.804484 2.654988 0.10619954 ## 6 3.335703 3.335703 3.590285 0.14361141 7.090860 3.494796 0.13979183 ## AUCPEP AUMCLST AUMCIFO AUMCPEO AUMCIFP AUMCPEP MRTIVLST MRTIVIFO ## 1 13.460844 3.271250 7.792554 58.02083 7.815026 58.14153 1.603199 3.307161 ## 2 7.074344 6.398750 9.391522 31.86674 9.195343 30.41314 1.969743 2.673229 ## 3 2.596369 5.006250 6.972678 28.20191 5.988790 16.40632 1.408457 1.862339 ## 4 2.457520 4.381875 5.948903 26.34146 5.097338 14.03601 1.573227 2.024142 ## 5 7.387236 3.707500 6.545866 43.36120 6.052534 38.74467 1.507814 2.427768 ## 6 4.552269 5.532500 8.289291 33.25726 7.255264 23.74502 1.658571 2.308811 ## MRTIVIFP VZO VZP CLO CLP VSSO VSSP ## 1 3.314490 67.01598 66.97136 10.610002 10.602939 35.08898 35.14333 ## 2 2.630377 23.54132 23.65814 7.116070 7.151384 19.02289 18.81084 ## 3 1.641139 15.82695 16.23844 6.677274 6.850879 12.43535 11.24324 ## 4 1.785125 18.67703 19.22334 8.506369 8.755181 17.21810 15.62909 ## 5 2.279684 36.68535 37.25547 9.272141 9.416237 22.51060 21.46604 ## 6 2.076019 19.69683 20.23502 6.963235 7.153494 16.07680 14.85079 5.4 R package: PKNCA https://github.com/billdenney/pknca 5.4.1 Pros Open source and free of charge CDISC SDTM semi compatible (output) Calculate partial(interval) AUC with ‘linear’ or ‘log’ interpolation method but in a cumbersome way 5.4.2 Cons CDISC SDTM not compatible (input) More tests required Experience with R language required Generating plots not supported for now (To be supported soon) library(PKNCA) my.conc &lt;- PKNCAconc(as.data.frame(Theoph), conc~Time|Subject) d.dose &lt;- unique(datasets::Theoph[datasets::Theoph$Time == 0, c(&quot;Dose&quot;, &quot;Time&quot;, &quot;Subject&quot;)]) my.dose &lt;- PKNCAdose(d.dose, Dose~Time|Subject) ## Assuming route of administration is extravascular ## Assuming instant dosing (duration=0) my.data.automatic &lt;- PKNCAdata(my.conc, my.dose) my.results.automatic &lt;- pk.nca(my.data.automatic) my.results.automatic$result %&gt;% filter(grepl(pattern = &quot;cmax|aucinf&quot;, PPTESTCD)) %&gt;% arrange(PPTESTCD) ## start end Subject PPTESTCD PPORRES exclude ## 1 0 Inf 1 aucinf.obs 214.92363 &lt;NA&gt; ## 2 0 Inf 2 aucinf.obs 97.37793 &lt;NA&gt; ## 3 0 Inf 3 aucinf.obs 106.12767 &lt;NA&gt; ## 4 0 Inf 4 aucinf.obs 114.21620 &lt;NA&gt; ## 5 0 Inf 5 aucinf.obs 136.30473 &lt;NA&gt; ## 6 0 Inf 6 aucinf.obs 82.17588 &lt;NA&gt; ## 7 0 Inf 7 aucinf.obs 100.98763 &lt;NA&gt; ## 8 0 Inf 8 aucinf.obs 102.15330 &lt;NA&gt; ## 9 0 Inf 9 aucinf.obs 97.52000 &lt;NA&gt; ## 10 0 Inf 10 aucinf.obs 167.86003 &lt;NA&gt; ## 11 0 Inf 11 aucinf.obs 86.90262 &lt;NA&gt; ## 12 0 Inf 12 aucinf.obs 125.83154 &lt;NA&gt; ## 13 0 Inf 1 cmax 10.50000 &lt;NA&gt; ## 14 0 Inf 2 cmax 8.33000 &lt;NA&gt; ## 15 0 Inf 3 cmax 8.20000 &lt;NA&gt; ## 16 0 Inf 4 cmax 8.60000 &lt;NA&gt; ## 17 0 Inf 5 cmax 11.40000 &lt;NA&gt; ## 18 0 Inf 6 cmax 6.44000 &lt;NA&gt; ## 19 0 Inf 7 cmax 7.09000 &lt;NA&gt; ## 20 0 Inf 8 cmax 7.56000 &lt;NA&gt; ## 21 0 Inf 9 cmax 9.03000 &lt;NA&gt; ## 22 0 Inf 10 cmax 10.21000 &lt;NA&gt; ## 23 0 Inf 11 cmax 8.00000 &lt;NA&gt; ## 24 0 Inf 12 cmax 9.75000 &lt;NA&gt; summary(my.results.automatic) ## start end N auclast cmax tmax half.life ## 1 0 24 12 74.6 [24.3] . . . ## 2 0 Inf 12 . 8.65 [17.0] 1.14 [0.630, 3.55] 8.18 [2.12] ## aucinf.obs ## 1 . ## 2 115 [28.4] 5.5 R package: ncappc NCA Calculation and Population PK Model Diagnosis (Acharya et al. 2016) https://cran.r-project.org/web/packages/ncappc/index.html https://www.ncbi.nlm.nih.gov/pubmed/27000291 #install.packages(&quot;ncappc&quot;) library(ncappc) ## Loading required package: ggplot2 ## ## Attaching package: &#39;ggplot2&#39; ## The following object is masked from &#39;package:pkr&#39;: ## ## unit ## Loading required package: gridExtra ## ## Attaching package: &#39;gridExtra&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## combine library(ncappc) write.csv(Theoph %&gt;% rename(ID = Subject, TIME = Time, DV = conc), &quot;Theoph.csv&quot;, row.names = FALSE) ncappc(obsFile=&quot;Theoph.csv&quot;, psnOut = FALSE, noPlot = TRUE, printOut = TRUE, method = &quot;linear-log&quot;, evid = FALSE) Theoph_ncappc &lt;- read.delim(&quot;ncaOutput-.tsv&quot;, sep = &quot;\\t&quot;, check.names = FALSE) Theoph_ncappc[ , c(&quot;Cmax (M.L^-3)&quot;, &quot;AUCINF_obs (T*M.L^-3)&quot;)] ## Cmax (M.L^-3) AUCINF_obs (T*M.L^-3) ## 1 10.50 214.9236 ## 2 8.33 97.3779 ## 3 8.20 106.1277 ## 4 8.60 114.2162 ## 5 11.40 136.3047 ## 6 6.44 82.1759 ## 7 7.09 100.9876 ## 8 7.56 102.1533 ## 9 9.03 97.5200 ## 10 10.21 167.8600 ## 11 8.00 86.9026 ## 12 9.75 125.8315 5.6 R package: PK Basic Non-Compartmental Pharmacokinetics https://cran.r-project.org/web/packages/PK/index.html #install.packages(&quot;PK&quot;) library(PK) ## ********** PK Version 1.3-3********** ## Type PKNews() to see new features/changes/bug fixes. 5.7 Kinetica 5.8 Scientist 5.9 PKSolver 5.10 Summary Description Industry standard CDISC Input CDISC Output Multiple Dose NCA Urine NCA Cost WinNonLin Yes Not supported Partially supported Yes Yes \\($\\) ncar No Supported Fully supported No No Free PKNCA No Not supported Partially supported ? No Free ncanpp No Not supported Not supported ? ? Free PK No Not supported Not supported ? ? Free Kinetica ? ? ? ? ? ? PK module in R ? ? ? ? ? ? Scientist ? ? ? ? ? ? PKSolver ? ? ? ? ? ? References "],
["result.html", "Chapter 6 결과 및 논의", " Chapter 6 결과 및 논의 현재 테오필린(theophylline)과 인도메타신(indomethacin)에 대해서 NCA 를 구할 수 있도록 시스템을 구축하였다. 약물을 선택한 후 각 약물의 복용량, 감소 구간에서의 log 치환 여부, 복용방법, 정맥주사일 경우 투입 시간(정맥주사 이외의 값들 경우에는 infusion time은 내부 함수에 따라 값이 적용되지 않는다.)을 각각 설정할 경우 값을 도출할 수 있다. Edison 내에서 실제 Theophylline의 용량에 따라 구현된 각각의 graph를 spaghetti plot형태로 Edison의 결과 가시화 tab을 이용하여 확인할 수 있으며, 그래프의 형태를 변형할 수 있게 설정하였다. Y축(농도)의 경우 linear plot과 semi-logarithmic plot을 모두 함께 확인할 수 있도록 하여 다양한 구간에서의 그래프의 추세를 선택적으로 확인할 수 있도록 하였다. 언급하였던 공식 이외에도 Pharmacokinetic and Pharmacodynamic Data Analysis 5th edition 에 언급된 공식을 적용하여 다음과 같이 값을 도출하였다.(figure 8) 또한 결과 값이 모두 도출된 이후 실제 NCA program으로 가장 흔히 사용되고 있는 WinNonlin® (Version 7.0 Pharsight, CA, USA) software 와의 결과 비교에서도 모든 조건을 현재 Edison simulator에서 준 값과 동일하게 설정하여 프로그램을 실행할 경우, 모든 지표에서 같은 값이 계산됨을 확인하였다. (figure 8, figure 9) 현재 가장 간단한 분석 방식인 비구획 분석을 통해서 약동학 분석에 필수적인 지표들을 산출해 내었지만, 마찬가지로 수학적 원리를 반영하여 R script를 구성한다면 보다 고차원적적 약동학 분석 방법인 구획 분석(Compartmental analysis)과 비선형적 약동학(nonlinear mixed effect modeling) 분석 또한 실시할 수 있다. 실제로 Edison 사이언스 엡에 추가한 ‘NONMEM(Nonlinear mixed effect modeling), method’라는 엡을 통해 현재 입력 되어있는 Theoph(theophylline)의 시간 농도 데이터를 가지고 FO(first-order method), FOCE(first-order conditional estimation method), LAPL(Laplace’s method)의 방법을 이용하여 현재 사용하는 NONMEM software와 유사한 값들을 재현해 낼 수 있다. Figure 4 논문 내에서의 설정 값 Figure 5. 앞서 설정한 Theophylline에 대한 linear spaghetti plot Figure 6. 앞서 설정한 Theophylline에 대한 scatter plot Figure 7. 앞서 설정한 Theophylline에 대한 semi-logarithmic spaghetti plot Figure 8. 앞서 설정한 Theophylline에 대한 NCA 분석 결과 Figure 9. Theophylline에 대하여 같은 data와 설정값으로 계산한 WinNonlin® (Version 7.0 Pharsight, CA, USA) software의 결과 Figure 10. NONMEM(Nonlinear mixed effect modeling), method 엡에 입력되어 있는 theophylline data의 농도 시간 곡선 Figure 11. theophylline data에 대한 model Figure 12. nonlinear mixed effect modeling First order method를 통해 도출된 parameter "],
["conclusion.html", "Chapter 7 결론", " Chapter 7 결론 약물을 연구하고 개발하는데 있어서 약동학은 굉장히 필수적인 분야이며, 그 동안 이러한 약동학 지표들을 구하기 위해서 그러한 결론이 도출되는 과정을 고려하지 않고 일부 프로그램의 사용에만 의존하는 모습이 주를 이루습니다. 하지만 이번 Edison program과 다양한 수학적, 통계적 지식을 coding에 활용하여 실제 임상적으로도 활용 가능한 결과값을 도출해 낼 수 있음을 확인하였으며 앞으로도 약동학 분야에서 다양하게 활용할 수 있을 것으로 예측됩니다. "],
["acknowledgement.html", "Chapter 8 감사의 글", " Chapter 8 감사의 글 본 논문은 2016년도 정부(미래창조과학부)의 재원으로 한국연구재단 첨단 사이언스·교육 허브 개발 사업의 지원을 받아 수행된 연구임(NRF-2016-936606). "],
["bibliography.html", "Chapter 9 참고문헌", " Chapter 9 참고문헌 [1] U.S. Department of Health and Human Services Food and Drug Administration Center for Drug Evaluation and Research (CDER) , Guidance for Industry Pharmacokinetics in Pregnancy — Study Design, Data Analysis, and Impact on Dosing and Labeling, (2004) [2] Malcolm Rowland and Thomas N. Tozer PharmD PhD, Clinical Pharmacokinetics and Pharmacodynamics : Concepts and Applications 4th Ed. 2010 (ISBN:9780781750097) [3] Hadley Wickham, Advanced R (Chapman &amp; Hall/CRC The R Series) 1st Ed ,25 sep 2014 [4] Gabrielsson J and Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016. (ISBN:9198299107). [5] http://www.edison.re.kr. EDISON 웹사이트. "],
["references.html", "References", " References "]
]
