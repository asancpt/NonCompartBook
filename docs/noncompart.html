<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R을 사용한 비구획분석 v0.1.0</title>
  <meta name="description" content="이 책은 R 패키지를 사용하여 비구획분석을 쉽게 따라할 수 있도록 쓰여졌습니다. 값비싼 상용소프트웨어와 동일한 결과를 얻으면서, 한번 익혀두면 속도와 연속성 측면에서 잇점이 많은 것을 발견할 수 있을 것입니다. 무엇보다 무료로 사용할 수 있는 R기반의 공개 소프트웨어라는 점에서 많은 연구자 혹은 기관에서 손쉽게 설치하고 실행할 수 있으리라 생각됩니다.">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R을 사용한 비구획분석 v0.1.0" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://asancpt.github.io/book-ncar" />
  <meta property="og:image" content="http://asancpt.github.io/book-ncarassets/cover.jpg" />
  <meta property="og:description" content="이 책은 R 패키지를 사용하여 비구획분석을 쉽게 따라할 수 있도록 쓰여졌습니다. 값비싼 상용소프트웨어와 동일한 결과를 얻으면서, 한번 익혀두면 속도와 연속성 측면에서 잇점이 많은 것을 발견할 수 있을 것입니다. 무엇보다 무료로 사용할 수 있는 R기반의 공개 소프트웨어라는 점에서 많은 연구자 혹은 기관에서 손쉽게 설치하고 실행할 수 있으리라 생각됩니다." />
  <meta name="github-repo" content="asancpt/book-ncar" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R을 사용한 비구획분석 v0.1.0" />
  
  <meta name="twitter:description" content="이 책은 R 패키지를 사용하여 비구획분석을 쉽게 따라할 수 있도록 쓰여졌습니다. 값비싼 상용소프트웨어와 동일한 결과를 얻으면서, 한번 익혀두면 속도와 연속성 측면에서 잇점이 많은 것을 발견할 수 있을 것입니다. 무엇보다 무료로 사용할 수 있는 R기반의 공개 소프트웨어라는 점에서 많은 연구자 혹은 기관에서 손쉽게 설치하고 실행할 수 있으리라 생각됩니다." />
  <meta name="twitter:image" content="http://asancpt.github.io/book-ncarassets/cover.jpg" />

<meta name="author" content="배균섭, 한성필, 윤석규, 조용순">


<meta name="date" content="2017-09-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="r-packages.html">
<link rel="next" href="ncar.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">R을 사용한 비구획분석</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>책 머리에</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i>감사의 글</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> 비구획 분석이란</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#summary-introduction"><i class="fa fa-check"></i><b>1.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#section-1.2"><i class="fa fa-check"></i><b>1.2</b> 약동학</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#method"><i class="fa fa-check"></i><b>1.3</b> 비구획 분석 이론 및 계산 방법</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-packages.html"><a href="r-packages.html"><i class="fa fa-check"></i><b>2</b> R 패키지</a><ul>
<li class="chapter" data-level="2.1" data-path="r-packages.html"><a href="r-packages.html#summary-r-packages"><i class="fa fa-check"></i><b>2.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="2.2" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i><b>2.2</b> 패키지에 대하여</a></li>
<li class="chapter" data-level="2.3" data-path="r-packages.html"><a href="r-packages.html#section-2.3"><i class="fa fa-check"></i><b>2.3</b> 설치</a></li>
<li class="chapter" data-level="2.4" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i><b>2.4</b> 기타 설치</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="noncompart.html"><a href="noncompart.html"><i class="fa fa-check"></i><b>3</b> R을 사용한 비구획분석</a><ul>
<li class="chapter" data-level="3.1" data-path="noncompart.html"><a href="noncompart.html#summary-noncompart"><i class="fa fa-check"></i><b>3.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="3.2" data-path="noncompart.html"><a href="noncompart.html#TheophData"><i class="fa fa-check"></i><b>3.2</b> 데이타에 대해</a></li>
<li class="chapter" data-level="3.3" data-path="noncompart.html"><a href="noncompart.html#noncompart-"><i class="fa fa-check"></i><b>3.3</b> NonCompart 사용법</a></li>
<li class="chapter" data-level="3.4" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i><b>3.4</b> 함수 살펴보기</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ncar.html"><a href="ncar.html"><i class="fa fa-check"></i><b>4</b> R을 사용한 비구획분석 보고서</a><ul>
<li class="chapter" data-level="4.1" data-path="ncar.html"><a href="ncar.html#summary-ncar"><i class="fa fa-check"></i><b>4.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="4.2" data-path="ncar.html"><a href="ncar.html#ncar-"><i class="fa fa-check"></i><b>4.2</b> ncar 사용법</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pkr.html"><a href="pkr.html"><i class="fa fa-check"></i><b>5</b> R을 사용한 비구획분석 시각화</a><ul>
<li class="chapter" data-level="5.1" data-path="pkr.html"><a href="pkr.html#summary-pkr"><i class="fa fa-check"></i><b>5.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="5.2" data-path="pkr.html"><a href="pkr.html#pkr-"><i class="fa fa-check"></i><b>5.2</b> pkr 사용법</a></li>
<li class="chapter" data-level="5.3" data-path="pkr.html"><a href="pkr.html#pros"><i class="fa fa-check"></i><b>5.3</b> Pros</a></li>
<li class="chapter" data-level="5.4" data-path="pkr.html"><a href="pkr.html#cons"><i class="fa fa-check"></i><b>5.4</b> Cons</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>6</b> R을 사용한 약동학 시뮬레이션</a><ul>
<li class="chapter" data-level="6.1" data-path="simulation.html"><a href="simulation.html#summary-simulation"><i class="fa fa-check"></i><b>6.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="6.2" data-path="index.html"><a href="index.html#-"><i class="fa fa-check"></i><b>6.2</b> 시뮬레이션에 대하여</a></li>
<li class="chapter" data-level="6.3" data-path="simulation.html"><a href="simulation.html#--"><i class="fa fa-check"></i><b>6.3</b> 시뮬레이션 후 비구획분석</a></li>
<li class="chapter" data-level="6.4" data-path="simulation.html"><a href="simulation.html#---"><i class="fa fa-check"></i><b>6.4</b> 앱을 통해 살펴보는 시뮬레이션</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="result.html"><a href="result.html"><i class="fa fa-check"></i><b>7</b> 결과 및 논의</a></li>
<li class="chapter" data-level="8" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>8</b> 결론</a></li>
<li class="appendix"><span><b>부록</b></span></li>
<li class="chapter" data-level="A" data-path="softwares.html"><a href="softwares.html"><i class="fa fa-check"></i><b>A</b> 비구획분석 소프트웨어</a><ul>
<li class="chapter" data-level="A.1" data-path="softwares.html"><a href="softwares.html#detailschapter"><i class="fa fa-check"></i><b>A.1</b> 이 장에서는</a></li>
<li class="chapter" data-level="A.2" data-path="softwares.html"><a href="softwares.html#certara-phoenix-winnonlin"><i class="fa fa-check"></i><b>A.2</b> Certara Phoenix WinNonLin</a><ul>
<li class="chapter" data-level="A.2.1" data-path="softwares.html"><a href="softwares.html#pros-1"><i class="fa fa-check"></i><b>A.2.1</b> Pros</a></li>
<li class="chapter" data-level="A.2.2" data-path="softwares.html"><a href="softwares.html#cons-1"><i class="fa fa-check"></i><b>A.2.2</b> Cons</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="softwares.html"><a href="softwares.html#r-package-pknca"><i class="fa fa-check"></i><b>A.3</b> R package: PKNCA</a><ul>
<li class="chapter" data-level="A.3.1" data-path="softwares.html"><a href="softwares.html#isop-pharmacometrics-study-group-presentation"><i class="fa fa-check"></i><b>A.3.1</b> ISoP Pharmacometrics Study Group Presentation</a></li>
<li class="chapter" data-level="A.3.2" data-path="softwares.html"><a href="softwares.html#-nca----."><i class="fa fa-check"></i><b>A.3.2</b> 오픈소스 NCA - 지금이 적기이다.</a></li>
<li class="chapter" data-level="A.3.3" data-path="ms-30-NonCompart.html"><a href="#section-A.3.3"><i class="fa fa-check"></i><b>A.3.3</b> 한계</a></li>
<li class="chapter" data-level="A.3.4" data-path="softwares.html"><a href="softwares.html#pknca--0.7"><i class="fa fa-check"></i><b>A.3.4</b> PKNCA 현재는 0.7</a></li>
<li class="chapter" data-level="A.3.5" data-path="softwares.html"><a href="softwares.html#pknca--1.0-."><i class="fa fa-check"></i><b>A.3.5</b> PKNCA 곧 1.0이 나올것이다.</a></li>
<li class="chapter" data-level="A.3.6" data-path="ms-30-NonCompart.html"><a href="#section-A.3.6"><i class="fa fa-check"></i><b>A.3.6</b> 참고사항</a></li>
<li class="chapter" data-level="A.3.7" data-path="softwares.html"><a href="softwares.html#rstudio--hands-on-"><i class="fa fa-check"></i><b>A.3.7</b> RStudio를 사용한 Hands-on 실습</a></li>
<li class="chapter" data-level="A.3.8" data-path="softwares.html"><a href="softwares.html#closing"><i class="fa fa-check"></i><b>A.3.8</b> Closing</a></li>
<li class="chapter" data-level="A.3.9" data-path="ms-30-NonCompart.html"><a href="#section-A.3.9"><i class="fa fa-check"></i><b>A.3.9</b> 결론</a></li>
<li class="chapter" data-level="A.3.10" data-path="softwares.html"><a href="softwares.html#pros-2"><i class="fa fa-check"></i><b>A.3.10</b> Pros</a></li>
<li class="chapter" data-level="A.3.11" data-path="softwares.html"><a href="softwares.html#cons-2"><i class="fa fa-check"></i><b>A.3.11</b> Cons</a></li>
</ul></li>
<li class="chapter" data-level="A.4" data-path="softwares.html"><a href="softwares.html#r-package-ncappc"><i class="fa fa-check"></i><b>A.4</b> R package: ncappc</a></li>
<li class="chapter" data-level="A.5" data-path="softwares.html"><a href="softwares.html#r-package-pk"><i class="fa fa-check"></i><b>A.5</b> R package: PK</a></li>
<li class="chapter" data-level="A.6" data-path="softwares.html"><a href="softwares.html#kinetica"><i class="fa fa-check"></i><b>A.6</b> Kinetica</a></li>
<li class="chapter" data-level="A.7" data-path="softwares.html"><a href="softwares.html#scientist"><i class="fa fa-check"></i><b>A.7</b> Scientist</a></li>
<li class="chapter" data-level="A.8" data-path="softwares.html"><a href="softwares.html#pksolver"><i class="fa fa-check"></i><b>A.8</b> PKSolver</a></li>
<li class="chapter" data-level="A.9" data-path="softwares.html"><a href="softwares.html#summary"><i class="fa fa-check"></i><b>A.9</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i>sessionInfo</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://github.com/asancpt/book-ncar">book-ncar Github 저장소</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R을 사용한 비구획분석 v0.1.0</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="noncompart" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> R을 사용한 비구획분석</h1>
<div id="summary-noncompart" class="section level2">
<h2><span class="header-section-number">3.1</span> 이 장에서는</h2>
<p><code>NonCompart</code> <span class="citation">(Bae <a href="#ref-R-NonCompart">2017</a><a href="#ref-R-NonCompart">b</a>)</span>, <code>ncar</code> <span class="citation">(Bae <a href="#ref-R-ncar">2017</a><a href="#ref-R-ncar">a</a>)</span> 은 비구획 분석을 R을 통해 쉽고 빠르게 (매우 빠르게) 행할 수 있는 패키지입니다. <code>NonCompart</code>의 제목은 Noncompartmental Analysis for Pharmacokinetic Data이고, <code>ncar</code>의 제목은 Noncompartmental Analysis for Pharmacokinetic Report입니다. 이에 대해 알아보겠습니다.</p>
</div>
<div id="TheophData" class="section level2">
<h2><span class="header-section-number">3.2</span> 데이타에 대해</h2>
<p>R에는 theophylline과 Indomethacin의 약동학 데이터가 내장되어 있습니다.</p>
<ul>
<li><code>Theoph</code>: theophylline의 약동학 데이터, 12명, 320mg PO 단회투여, 0~24시간 채혈, NONMEM 의 run 폴더의 THEOPP 데이터와 동일합니다.</li>
<li><code>Indometh</code>: Indomethacin의 약동학 데이터, 6명, 25mg IV bolus 단회투여, 0~8시간 채혈(0, 0.25, 0.5, 0.75, 1, 1.25, 2, 3, 4, 5, 6, 8 h) (데이터명의 첫글짜가 대문자임에 주의하길)</li>
</ul>
<p>먼저 데이터를 살펴보겠습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(Theoph)</code></pre></div>
<pre><code>## Grouped Data: conc ~ Time | Subject
##   Subject   Wt Dose Time  conc
## 1       1 79.6 4.02 0.00  0.74
## 2       1 79.6 4.02 0.25  2.84
## 3       1 79.6 4.02 0.57  6.57
## 4       1 79.6 4.02 1.12 10.50
## 5       1 79.6 4.02 2.02  9.66
## 6       1 79.6 4.02 3.82  8.58</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(Theoph)</code></pre></div>
<pre><code>## Grouped Data: conc ~ Time | Subject
##     Subject   Wt Dose  Time conc
## 127      12 60.5  5.3  3.52 9.75
## 128      12 60.5  5.3  5.07 8.57
## 129      12 60.5  5.3  7.07 6.59
## 130      12 60.5  5.3  9.03 6.11
## 131      12 60.5  5.3 12.05 4.57
## 132      12 60.5  5.3 24.15 1.17</code></pre>
<p>다음과 같이 테스트 할 수 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TheophNca &lt;-<span class="st"> </span><span class="kw">tblNCA</span>(Theoph, <span class="dt">key=</span><span class="st">&quot;Subject&quot;</span>, <span class="dt">dose=</span><span class="dv">320</span>, <span class="dt">concUnit=</span><span class="st">&quot;mg/L&quot;</span>)</code></pre></div>
<p>이는 문자(character)로 구성된 matrix로 구성된 결과물과 단위 정보가 담긴 attribute를 포함하고 있습니다.</p>
<p>데이터가 Subject, weight, Dose, Time, Concentration 으로 구성되었음을 알 수 있습니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Backbone &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Theoph <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                       </span><span class="kw">mutate</span>(<span class="dt">Subject =</span> <span class="kw">as.numeric</span>(Subject)), 
                   <span class="kw">aes</span>(Time, conc, <span class="dt">group =</span> Subject, <span class="dt">colour =</span> Wt)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() 

Individual &lt;-<span class="st"> </span>Backbone <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>Subject) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>()
groupLinear &lt;-<span class="st"> </span>Backbone
groupLog &lt;-<span class="st"> </span>groupLinear <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>()

<span class="kw">ggdraw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(Individual, <span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>, .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(groupLinear, <span class="dv">0</span>, <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(groupLog, .<span class="dv">5</span>, <span class="dv">0</span>, .<span class="dv">5</span>, .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot_label</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">size =</span> <span class="dv">15</span>)</code></pre></div>
<pre><code>## Warning: Transformation introduced infinite values in continuous y-axis

## Warning: Transformation introduced infinite values in continuous y-axis

## Warning: Transformation introduced infinite values in continuous y-axis

## Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
<div class="figure"><span id="fig:TheophFig"></span>
<img src="book-ncar_files/figure-html/TheophFig-1.png" alt="Theoph 데이타를 시각화. A) Individual concentration-time curves, B) linear concentration-time curves, C) semi-logarithmic concentration-time curves" width="768" />
<p class="caption">
Figure 3.1: Theoph 데이타를 시각화. A) Individual concentration-time curves, B) linear concentration-time curves, C) semi-logarithmic concentration-time curves
</p>
</div>
<p>이 패키지로 NCA 비구획방법으로 약동학 파라미터를 산출하기 위해서는 아래와 같이 하면 됩니다. 우선 Theophilline 의 약동학 파라미터를 구해보면,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NonCompart<span class="op">::</span><span class="kw">tabNCA</span>(Theoph, <span class="st">&quot;Subject&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="dt">dose=</span><span class="dv">320</span>)</code></pre></div>
<pre><code>## Error: &#39;tabNCA&#39; is not an exported object from &#39;namespace:NonCompart&#39;</code></pre>
<p>다음으로 Indomethacin 의 약동학 파라미터를 구해보자. 이는 IV bolus 이므로 AdmMode 옵션이 추가된다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">NonCompart<span class="op">::</span><span class="kw">tabNCA</span>(Indometh, <span class="st">&quot;Subject&quot;</span>, <span class="st">&quot;time&quot;</span>, <span class="st">&quot;conc&quot;</span>, <span class="dt">dose=</span><span class="dv">25</span>, <span class="dt">adm=</span><span class="st">&quot;Bolus&quot;</span>, <span class="dt">dur=</span><span class="fl">0.5</span>, <span class="dt">concUnit=</span><span class="st">&quot;mg/L&quot;</span>)</code></pre></div>
<pre><code>## Error: &#39;tabNCA&#39; is not an exported object from &#39;namespace:NonCompart&#39;</code></pre>
</div>
<div id="noncompart-" class="section level2">
<h2><span class="header-section-number">3.3</span> NonCompart 사용법</h2>
<p>NCA의 사용법은 다음과 같다. NCA(Data, colSubj, colTime, colConc, colTrt, Method = “Linear”, Dose = 0, AdmMode = “Extravascular”, TimeInfusion = 0, Report = “Table”, iAUC) Data는 데이터셋을 설정하며. colSubj는 subject ID의 컬럼명, colTime은 time의 컬럼명, colConc는 concentration의 컬럼명, colTrT는 treatment code의 컬럼명(교차시험에서 사용)이다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tabNCA</span>(concData, <span class="dt">colSubj =</span> <span class="st">&quot;Subject&quot;</span>, <span class="dt">colTime =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">colConc =</span> <span class="st">&quot;conc&quot;</span>, <span class="dt">dose =</span> <span class="dv">0</span>, 
       <span class="dt">adm =</span> <span class="st">&quot;Extravascular&quot;</span>, <span class="dt">dur =</span> <span class="dv">0</span>, <span class="dt">doseUnit =</span> <span class="st">&quot;mg&quot;</span>, <span class="dt">timeUnit =</span> <span class="st">&quot;h&quot;</span>, 
       <span class="dt">concUnit =</span> <span class="st">&quot;ug/L&quot;</span>, <span class="dt">down =</span> <span class="st">&quot;Linear&quot;</span>, <span class="dt">MW =</span> <span class="dv">0</span>, <span class="dt">returnNA =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(NonCompart<span class="op">::</span>tblNCA)</code></pre></div>
<pre><code>## function (concData, key = &quot;Subject&quot;, colTime = &quot;Time&quot;, colConc = &quot;conc&quot;, 
##     dose = 0, adm = &quot;Extravascular&quot;, dur = 0, doseUnit = &quot;mg&quot;, 
##     timeUnit = &quot;h&quot;, concUnit = &quot;ug/L&quot;, down = &quot;Linear&quot;, MW = 0) 
## NULL</code></pre>
<p>NCA의 옵션들에 대해서 간단히 살펴보자면 다음과 같다.</p>
<ol style="list-style-type: decimal">
<li>Method
<ul>
<li>AUC와 AUMC를 구하는 trapezoidal method 설정, 기본값은 Method=“Linear”</li>
<li>Linear와 Log 중 선택 가능하다.</li>
<li>Linear는 Linear trapezoidal method이며, Log는 Linear-up and log-down method 입니다.</li>
</ul></li>
<li>Dose
<ul>
<li>투여량에 대한 설정이다. 단위에 주의해야 한다. 벡터값을 줌으로서 각 대상자별 용량을 다르게 할 수 있습니다.</li>
</ul></li>
<li>AdmMode
<ul>
<li>투여경로에 대한 설정, 기본값은 AdmMode= “Extravascular”</li>
<li>Bolus, Infusion, Extravascular 중에서 선택 가능하다.</li>
</ul></li>
<li>TimeInfusion
<ul>
<li>주입하는 기간(infusion duration)을 설정한다. 기본값은 0이다.</li>
</ul></li>
<li>iAUC
<ul>
<li>일부구간에 대한 AUC를 구하기 위한 구간설정 옵션입니다.</li>
<li>“Name”, “Start”, “End” 3개의 컬럼으로 구성된 데이터 프레임으로 설정해야 합니다.</li>
</ul></li>
</ol>
<p>일부 구간의 AUC를 구하는 방법은 조금 더 복잡하므로 자세히 알아보자. 예를 들어 0~12시간까지의 AUC, 0~24시간까지의 AUC를 구하고자 한다면 다음과 같이 하면 된다. 먼저 구하고자 하는 구간에 대한 정보를 갖는 변수를 아래와같이 생성한다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iAUC =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Name=</span><span class="kw">c</span>(<span class="st">&quot;AUC[0-12h]&quot;</span>,<span class="st">&quot;AUC[0-24h]&quot;</span>), <span class="dt">Start=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">End=</span><span class="kw">c</span>(<span class="dv">12</span>,<span class="dv">24</span>)) ; iAUC</code></pre></div>
<pre><code>##         Name Start End
## 1 AUC[0-12h]     0  12
## 2 AUC[0-24h]     0  24</code></pre>
<pre><code>    Name Start End</code></pre>
<p>1 AUC[0-12h] 0 12 2 AUC[0-24h] 0 24</p>
<p>이제 iAUC 옵션을 이용해서 이를 구한다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># tabNCA(Theoph, &quot;Subject&quot;, &quot;Time&quot;, &quot;conc&quot;, dose=320, iAUC=iAUC)</span></code></pre></div>
<p>Subject CMAX CMAXD TMAX TLAG CLST CLSTP TLST LAMZHL LAMZ LAMZLL LAMZUL LAMZNPT CORRXY R2 R2ADJ 1 1 10.50 0.03281250 1.12 0 3.28 3.2801465 24.37 14.304378 0.04845700 9.05 24.37 3 -0.9999999 0.9999997 0.9999995 2 2 8.33 0.02603125 1.92 0 0.90 0.8886398 24.30 6.659342 0.10408644 7.03 24.30 4 -0.9985967 0.9971954 0.9957931 3 3 8.20 0.02562500 1.02 0 1.05 1.0550967 24.17 6.766087 0.10244431 9.00 24.17 3 -0.9996624 0.9993250 0.9986499 4 4 8.60 0.02687500 1.07 0 1.15 1.1564216 24.65 6.981247 0.09928702 9.02 24.65 3 -0.9994619 0.9989241 0.9978483 5 5 11.40 0.03562500 1.00 0 1.57 1.5556951 24.35 8.002264 0.08661888 7.02 24.35 4 -0.9993234 0.9986472 0.9979708 6 6 6.44 0.02012500 1.15 0 0.92 0.9412712 23.85 7.894998 0.08779574 2.03 23.85 7 -0.9991203 0.9982413 0.9978896 7 7 7.09 0.02215625 3.48 0 1.15 1.1607192 24.22 7.846668 0.08833650 6.98 24.22 4 -0.9993349 0.9986702 0.9980053 8 8 7.56 0.02362500 2.02 0 1.25 1.2285268 24.12 8.510038 0.08145054 3.53 24.12 6 -0.9954961 0.9910124 0.9887655 9 9 9.03 0.02821875 0.63 0 1.12 1.1164831 24.43 8.405999 0.08245863 8.80 24.43 3 -0.9997218 0.9994437 0.9988873 10 10 10.21 0.03190625 3.55 0 2.42 2.4136923 23.70 9.246916 0.07495982 9.38 23.70 3 -0.9997543 0.9995087 0.9990174 11 11 8.00 0.02500000 0.98 0 0.86 0.8598066 24.08 7.261237 0.09545856 9.03 24.08 3 -0.9999991 0.9999983 0.9999965 12 12 9.75 0.03046875 3.52 0 1.17 1.1755390 24.15 6.286508 0.11025949 9.03 24.15 3 -0.9996984 0.9993968 0.9987936 AUCLST AUCALL AUCIFO AUCIFOD AUCPEO AUCIFP AUCIFPD AUCPEP AUMCLST AUMCIFO AUMCPEO AUMCIFP AUMCPEP 1 148.92305 148.92305 216.61193 0.6769123 31.248917 216.61496 0.6769217 31.249876 1459.0711 4505.5348 67.61603 4505.6709 67.61701 2 91.52680 91.52680 100.17346 0.3130421 8.631687 100.06432 0.3127010 8.532030 706.5866 999.7723 29.32525 996.0716 29.06267 3 99.28650 99.28650 109.53597 0.3422999 9.357173 109.58572 0.3424554 9.398325 803.1859 1150.9648 30.21629 1152.6529 30.31850 4 106.79630 106.79630 118.37888 0.3699340 9.784331 118.44356 0.3701361 9.833594 901.0842 1303.2524 30.85881 1305.4981 30.97775 5 121.29440 121.29440 139.41978 0.4356868 13.000579 139.25463 0.4351707 12.897403 1017.1143 1667.7216 39.01174 1661.7937 38.79419 6 73.77555 73.77555 84.25442 0.2632951 12.437174 84.49670 0.2640522 12.688246 609.1524 978.4285 37.74176 986.9665 38.28034 7 90.75340 90.75340 103.77180 0.3242869 12.545221 103.89315 0.3246661 12.647366 782.4199 1245.0984 37.16000 1249.4111 37.37691 8 88.55995 88.55995 103.90669 0.3247084 14.769730 103.64305 0.3238845 14.552931 739.5346 1298.1158 43.03015 1288.5201 42.60589 9 86.32615 86.32615 99.90872 0.3122147 13.594978 99.86607 0.3120815 13.558076 705.2296 1201.7715 41.31750 1200.2124 41.24126 10 138.36810 138.36810 170.65206 0.5332877 18.918002 170.56791 0.5330247 18.878001 1278.1800 2473.9934 48.33535 2470.8765 48.27018 11 80.09360 80.09360 89.10274 0.2784461 10.110962 89.10072 0.2784397 10.108918 617.2422 928.5600 33.52694 928.4900 33.52193 12 119.97750 119.97750 130.58883 0.4080901 8.125757 130.63907 0.4082471 8.161087 977.8807 1330.3840 26.49636 1332.0528 26.58844 MRTEVLST MRTEVIFO MRTEVIFP VZFO VZFP CLFO CLFP AUC[0-12h] AUC[0-24h] 1 9.797483 20.800031 20.800368 30.48675 30.48632 1.477296 1.477276 91.73552 147.69459 2 7.719996 9.980411 9.954313 30.69044 30.72392 3.194459 3.197943 67.48030 91.24908 3 8.089578 10.507642 10.518276 28.51710 28.50415 2.921415 2.920088 70.17971 99.10481 4 8.437410 11.009163 11.022112 27.22596 27.21110 2.703185 2.701709 73.05115 105.99811 5 8.385501 11.961873 11.933490 26.49799 26.52942 2.295227 2.297949 84.61490 120.73101 6 8.256833 11.612785 11.680533 43.25973 43.13569 3.798020 3.787130 51.75887 73.91422 7 8.621383 11.998427 12.025924 34.90844 34.86767 3.083689 3.080088 62.09875 90.49567 8 8.350666 12.493092 12.432287 37.81051 37.90669 3.079686 3.087520 62.71486 88.40890 9 8.169363 12.028695 12.018220 38.84279 38.85938 3.202924 3.204292 60.12123 85.82985 10 9.237534 14.497296 14.486174 25.01554 25.02788 1.875160 1.876086 90.81742 139.08507 11 7.706511 10.421227 10.420679 37.62219 37.62304 3.591360 3.591441 58.53963 80.02431 12 8.150534 10.187579 10.196436 22.22429 22.21575 2.450439 2.449497 85.02136 119.79884</p>
<p>맨 마지막 파라미터로 AUC[0-12h], AUC[0-24h]가 추가되었음을 알 수 있다.</p>
</div>
<div id="-" class="section level2">
<h2><span class="header-section-number">3.4</span> 함수 살펴보기</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

AUC =<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">down=</span><span class="st">&quot;Linear&quot;</span>)
{
<span class="co"># Author: Kyun-Seop Bae k@acr.kr</span>
<span class="co"># Last modification; 2017-07-24</span>
<span class="co"># Called by: sNCA</span>
<span class="co"># Calls: UT</span>
<span class="co"># INPUT</span>
<span class="co">#    x: time or similar vector</span>
<span class="co">#    y: concentration or similar vector</span>

  n =<span class="st"> </span><span class="kw">length</span>(x)
<span class="co"># RETURNS</span>
  Result =<span class="st"> </span><span class="kw">c</span>(<span class="dt">AUC =</span> <span class="kw">rep</span>(<span class="ot">NA_real_</span>, n),   <span class="co"># vector of cumulative AUC</span>
             <span class="dt">AUMC =</span> <span class="kw">rep</span>(<span class="ot">NA_real_</span>, n))  <span class="co"># vector of cumulative AUMC</span>
<span class="co"># Input check</span>
  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(x) <span class="op">|</span><span class="st"> </span><span class="op">!</span><span class="kw">is.numeric</span>(y)) <span class="kw">return</span>(Result)

<span class="co">#</span>
  Res =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow=</span>n, <span class="dt">ncol=</span><span class="dv">2</span>) <span class="co"># temporary result</span>
  Res[<span class="dv">1</span>,] =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n) {
    <span class="cf">if</span> (y[i] <span class="op">&gt;=</span><span class="st"> </span>y[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]) { <span class="co"># if upward</span>
      Res[i,<span class="dv">1</span>] =<span class="st"> </span>(x[i] <span class="op">-</span><span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>(y[i] <span class="op">+</span><span class="st"> </span>y[i<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span>
      Res[i,<span class="dv">2</span>] =<span class="st"> </span>(x[i] <span class="op">-</span><span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>(x[i]<span class="op">*</span>y[i] <span class="op">+</span><span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>y[i<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span>
    } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">UT</span>(down) <span class="op">==</span><span class="st"> &quot;LINEAR&quot;</span>) { <span class="co"># downward &amp; linear</span>
      Res[i,<span class="dv">1</span>] =<span class="st"> </span>(x[i] <span class="op">-</span><span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>(y[i] <span class="op">+</span><span class="st"> </span>y[i<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span>
      Res[i,<span class="dv">2</span>] =<span class="st"> </span>(x[i] <span class="op">-</span><span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>])<span class="op">*</span>(x[i]<span class="op">*</span>y[i] <span class="op">+</span><span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>y[i<span class="op">-</span><span class="dv">1</span>])<span class="op">/</span><span class="dv">2</span>
    } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">UT</span>(down) <span class="op">==</span><span class="st"> &quot;LOG&quot;</span>) { <span class="co"># downward &amp; log</span>
      k =<span class="st"> </span>(<span class="kw">log</span>(y[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(y[i]))<span class="op">/</span>(x[i] <span class="op">-</span><span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]) <span class="co"># -k slope in y-log scale</span>
      Res[i,<span class="dv">1</span>] =<span class="st"> </span>(y[i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>y[i])<span class="op">/</span>k
      Res[i,<span class="dv">2</span>] =<span class="st"> </span>(x[i<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>y[i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>x[i]<span class="op">*</span>y[i])<span class="op">/</span>k <span class="op">+</span><span class="st"> </span>(y[i<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>y[i])<span class="op">/</span>k<span class="op">/</span>k
    } <span class="cf">else</span> {
      Res[i,<span class="dv">1</span>] =<span class="st"> </span><span class="ot">NA_real_</span>
      Res[i,<span class="dv">2</span>] =<span class="st"> </span><span class="ot">NA_real_</span>
    }
  }
  Result =<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">AUC=</span><span class="kw">cumsum</span>(Res[,<span class="dv">1</span>]), <span class="dt">AUMC=</span><span class="kw">cumsum</span>(Res[,<span class="dv">2</span>]))
  <span class="kw">return</span>(Result)
}</code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-NonCompart">
<p>Bae, Kyun-Seop. 2017b. <em>NonCompart: Noncompartmental Analysis for Pharmacokinetic Data</em>. <a href="https://CRAN.R-project.org/package=NonCompart" class="uri">https://CRAN.R-project.org/package=NonCompart</a>.</p>
</div>
<div id="ref-R-ncar">
<p>Bae, Kyun-Seop. 2017a. <em>Ncar: Noncompartmental Analysis for Pharmacokinetic Report</em>. <a href="https://CRAN.R-project.org/package=ncar" class="uri">https://CRAN.R-project.org/package=ncar</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-packages.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ncar.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/asancpt/book-ncar/edit/master/bookdown/ms-30-NonCompart.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
